-----------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/lsh152058/Documents/GitHub/ethnicity-covid-research/logs/
> 21_eth_outcome_characteristics.log
  log type:  text
 opened on:  13 Jan 2021, 12:42:31

. 
. foreach outcome of global outcomes {
  2.         
. * Open Stata dataset
. use ./output/analysis_dataset.dta, clear
  3. drop if carehome==1
  4. 
.  /* PROGRAMS TO AUTOMATE TABULATIONS=======================================
> ====*/ 
. 
. ***************************************************************************
> *****
. * All below code from K Baskharan 
. * Generic code to output one row of table
. 
. cap prog drop generaterow
  5. program define generaterow
  6. syntax, variable(varname) condition(string) 
  7.         
.         qui cou
  8.         local overalldenom=r(N)
  9.         
.         sum `variable' if `variable' `condition'
 10.         file write tablecontent (r(max)) _tab
 11.         
.         qui cou if `variable' `condition'
 12.         local rowdenom = r(N)
 13.         local colpct = 100*(r(N)/`overalldenom')
 14.         file write tablecontent %9.0gc (`rowdenom')  (" (") %3.1f (`colp
> ct') (")") _tab
 15. 
.         forvalues i=0/1{
 16.         qui cou if `outcome' == `i'
 17.         local rowdenom = r(N)
 18.         qui cou if `outcome' == `i' & `variable' `condition'
 19.         local pct = 100*(r(N)/`rowdenom') 
 20.         file write tablecontent %9.0gc (r(N)) (" (") %3.1f (`pct') (")")
>  _tab
 21.         }
 22.         
.         file write tablecontent _n
 23. end
--Break--
r(1);

end of do-file

--Break--
r(1);

. tab region

       Region of England |      Freq.     Percent        Cum.
-------------------------+-----------------------------------
           East Midlands |        795       10.07       10.07
         East of England |        832       10.54       20.61
                  London |      1,572       19.92       40.53
              North East |        784        9.93       50.46
              North West |        766        9.70       60.17
              South East |      1,585       20.08       80.25
           West Midlands |        778        9.86       90.11
Yorkshire and the Humber |        781        9.89      100.00
-------------------------+-----------------------------------
                   Total |      7,893      100.00

. do "/var/folders/jg/zvg1wn090ps86p3lwtn901140000gn/T//SD95913.000000"

. encode region, gen(region2)
variable region2 already defined
r(110);

end of do-file

r(110);

. tab region2, nol

  Region of |
    England |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        795       10.07       10.07
          2 |        832       10.54       20.61
          3 |      1,572       19.92       40.53
          4 |        784        9.93       50.46
          5 |        766        9.70       60.17
          6 |      1,585       20.08       80.25
          7 |        778        9.86       90.11
          8 |        781        9.89      100.00
------------+-----------------------------------
      Total |      7,893      100.00

. d *com*
----------------------------------------------------------------- begin d ---
- local version : di "version " string(_caller()) ":"
- `version' describe `0'
= version 16.1: describe *com*
  -------------------------------------------------------- begin describe ---
  - version 9
  - local version : di "version " string(_caller()) ":"
  - syntax [anything] [using] [, SImple REPLACE *]
  - if ("`replace'"!="") {
  = if (""!="") {
    describe_mk `0'
    return add
    exit
    }
  - local varlist `"`anything'"'
  = local varlist `"*com*"'
  - if ("`simple'" == "") {
  = if ("" == "") {
  - `version' _describe `0'
  = version 16.1: _describe *com*

              storage   display    value
variable name   type    format     label      variable label
-----------------------------------------------------------------------------
combination_b~s byte    %8.0g                 BP med in last 12 months
comorbidity_~nt float   %9.0g                 Count of co-morbid conditions
comorbidity_cat float   %9.0g                 Catgeorised co-morbidity count
  - return add
  - }
  - else {
    if (`"`options'"' != "") {
    di as err "simple may not be combined with other options"
    exit 198
    }
    if (`"`using'"' != "") {
    qui `version' describe `varlist' `using', varlist
    if "`varlist'" == "" {
    local vars "`r(varlist)'"
    }
    else {
    local vars "`varlist'"
    }
    local wid = 2
    local n : list sizeof vars
    if `n'==0 {
    exit
    }
    if "`c(hasicu)'" == "1" {
    foreach x of local vars {
    local wid = max(`wid', udstrlen(`"`x'"'))
    }
    }
    else {
    foreach x of local vars {
    local wid = max(`wid', strlen(`"`x'"'))
    }
    }
    local wid = `wid' + 2
    local cols = int((`c(linesize)'+1)/`wid')
    if `cols' < 2 {
    foreach x of local `vars' {
    di as txt `col' `"`x'"'
    }
    exit
    }
    local lines = `n'/`cols'
    local lines = int(cond(`lines'>int(`lines'), `lines'+1, `lines'))
    forvalues i=1(1)`lines' {
    local top = min((`cols')*`lines'+`i', `n')
    local col = 1
    forvalues j=`i'(`lines')`top' {
    local x : word `j' of `vars'
    di as txt _column(`col') "`x'" _c
    local col = `col' + `wid'
    }
    di as txt
    }
    qui `version' describe `varlist' `using', short
    return add
    }
    else {
    ds `varlist'
    qui `version' _describe `varlist', short
    return add
    }
    }
  ---------------------------------------------------------- end describe ---
------------------------------------------------------------------- end d ---

. set trace off

. d *comorb*

              storage   display    value
variable name   type    format     label      variable label
-----------------------------------------------------------------------------
comorbidity_~nt float   %9.0g                 Count of co-morbid conditions
comorbidity_cat float   %9.0g                 Catgeorised co-morbidity count

. d *hh*

              storage   display    value
variable name   type    format     label      variable label
-----------------------------------------------------------------------------
hh_id           int     %8.0g                 Household ID
hh_size         byte    %8.0g                 # people in household
hh_total_cat    float   %9.0g      hh_total_cat
                                              Number of people in household
hh_cat_2        float   %9.0g      hh_total_cat
                                              Household carehome excluding
                                                11+
hh_linear       float   %9.0g                 Linear household size
hh_log_linear   float   %9.0g                 Log linear household size

. tab hh_total_cat

  Number of |
  people in |
  household |      Freq.     Percent        Cum.
------------+-----------------------------------
        3-5 |        161        2.04        2.04
       6-10 |      6,562       83.14       85.18
        11+ |         11        0.14       85.32
   carehome |      1,159       14.68      100.00
------------+-----------------------------------
      Total |      7,893      100.00

. tab hh_total_cat, nol

  Number of |
  people in |
  household |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |        161        2.04        2.04
          3 |      6,562       83.14       85.18
          4 |         11        0.14       85.32
          5 |      1,159       14.68      100.00
------------+-----------------------------------
      Total |      7,893      100.00

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *Create table comparing characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. foreach i of global outcomes {
  2. ************************************************************************
> *******
. *Generic code to output one row of table
. cap prog drop generaterow
  3. program define generaterow
  4. syntax, variable(varname) condition(string)
  5.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  6.         
.         cou
  7.         local overalldenom=r(N)
  8.         
.         cou if `variable' `condition'
  9.         local rowdenom = r(N)
 10.         local colpct = 100*(r(N)/`overalldenom')
 11.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _n
 12. 
.         /*cou if `outcome'==1 & `variable' `condition'
>         local pct = 100*(r(N)/`rowdenom')
>         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n*/
. 
.         
. end
--Break--
r(1);

end of do-file

--Break--
r(1);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *Create table comparing characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. foreach i of global outcomes {
  2. ************************************************************************
> *******
. *Generic code to output one row of table
. cap prog drop generaterow
  3. program define generaterow
  4. syntax, variable(varname) condition(string)
  5.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  6.         
.         cou
  7.         local overalldenom=r(N)
  8.         
.         cou if `variable' `condition'
  9.         local rowdenom = r(N)
 10.         local colpct = 100*(r(N)/`overalldenom')
 11.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _n
 12. 
.         /*cou if `outcome'==1 & `variable' `condition'
>         local pct = 100*(r(N)/`rowdenom')
>         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n*/
. 
.         
. end
--Break--
r(1);

end of do-file

--Break--
r(1);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *Create table comparing characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. foreach i of global outcomes {
  2. ************************************************************************
> *******
. *Generic code to output one row of table
. cap prog drop generaterow
  3. program define generaterow
  4. syntax, variable(varname) condition(string)
  5.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  6.         
.         cou
  7.         local overalldenom=r(N)
  8.         
.         cou if `variable' `condition'
  9.         local rowdenom = r(N)
 10.         local colpct = 100*(r(N)/`overalldenom')
 11.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _n
 12. 
.         /*cou if `outcome'==1 & `variable' `condition'
>         local pct = 100*(r(N)/`rowdenom')
>         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n*/
. 
.         
. end
--Break--
r(1);

end of do-file

--Break--
r(1);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *Create table comparing characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. foreach i of global outcomes {
  2. ************************************************************************
> *******
. *Generic code to output one row of table
. cap prog drop generaterow
  3. program define generaterow
  4. syntax, variable(varname) condition(string)
  5.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  6.         
.         cou
  7.         local overalldenom=r(N)
  8.         
.         cou if `variable' `condition'
  9.         local rowdenom = r(N)
 10.         local colpct = 100*(r(N)/`overalldenom')
 11.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _n
 12. 
.         cou if `i'==1 & `variable' `condition'
 13.         local pct = 100*(r(N)/`rowdenom')
 14.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 15. 
.         
. end
--Break--
r(1);

end of do-file

--Break--
r(1);

. do "/var/folders/jg/zvg1wn090ps86p3lwtn901140000gn/T//SD95913.000000"

. foreach i of global outcomes {
  2. use ./analysis/analysis_dataset,clear
  3. keep if carehome==0
  4. cou
  5. }
file ./analysis/analysis_dataset.dta not found
r(601);

end of do-file

r(601);

. do "/var/folders/jg/zvg1wn090ps86p3lwtn901140000gn/T//SD95913.000000"

. foreach i of global outcomes {
  2. use ./output/analysis_dataset,clear
  3. keep if carehome==0
  4. cou
  5. }
(1,189 observations deleted)
  6,668
(1,189 observations deleted)
  6,668
(1,189 observations deleted)
  6,668
(1,189 observations deleted)
  6,668
(1,189 observations deleted)
  6,668
(1,189 observations deleted)
  6,668
(1,189 observations deleted)
  6,668

. 
end of do-file

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *Create table comparing characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. foreach i of global outcomes {
  2. use ./output/analysis_dataset,clear
  3. keep if carehome==0
  4. cou
  5. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow
  6. program define generaterow
  7. syntax, variable(varname) condition(string)
  8.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  9.         
.         cou
 10.         local overalldenom=r(N)
 11.         
.         cou if `variable' `condition'
 12.         local rowdenom = r(N)
 13.         local colpct = 100*(r(N)/`overalldenom')
 14.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _n
 15. 
.         cou if `i'==1 & `variable' `condition'
 16.         local pct = 100*(r(N)/`rowdenom')
 17.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 18. 
.         
. end
--Break--
r(1);

end of do-file

--Break--
r(1);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *Create table comparing characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. foreach i of global outcomes {
  2. use ./output/analysis_dataset,clear
  3. keep if carehome==0
  4. cou
  5. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow
  6. program define generaterow
  7. syntax, variable(varname) condition(string)
  8.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  9.         
.         cou
 10.         local overalldenom=r(N)
 11.         
.         cou if `variable' `condition'
 12.         local rowdenom = r(N)
 13.         local colpct = 100*(r(N)/`overalldenom')
 14.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _n
 15. 
.         cou if `i'==0 & `variable' `condition'
 16.         local pct = 100*(r(N)/`rowdenom')
 17.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 18. 
.         cou if `i'==1 & `variable' `condition'
 19.         local pct = 100*(r(N)/`rowdenom')
 20.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 21. 
.         
. end
--Break--
r(1);

end of do-file

--Break--
r(1);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *Create table comparing characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. foreach i of global outcomes {
  2. use ./output/analysis_dataset,clear
  3. keep if carehome==0
  4. cou
  5. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable
  6. prog define tabulatevariable
  7. syntax, variable(varname) start(real) end(real) [missing] 
  8. 
.         foreach varlevel of numlist `start'/`end'{ 
  9.                 generaterow, variable(`variable') condition("==`varlevel
> '") 
 10.         }
 11.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") 
 12. 
. end
--Break--
r(1);

end of do-file

--Break--
r(1);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *an_tablecontent_PublicationDescriptivesTable
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. foreach outcome of global outcomes {
  2. 
. *Set up output file
. cap file close tablecontent
  3. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  4. 
. 
. use cr_create_analysis_dataset,clear
  5. 
. gen byte cons=1
  6. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
  7. file write tablecontent _n 
  8. 
. qui summarizevariable, variable(age) 
  9. file write tablecontent _n
 10. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 13. file write tablecontent _n 
 14. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. encode region, gen(region2)
 17. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 18. file write tablecontent _n 
 19. 
. file close tablecontent
 20. }
(note: file ./output/Table1_tested.txt not found)
file cr_create_analysis_dataset.dta not found
r(601);

end of do-file

r(601);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. foreach outcome of global outcomes {
  2. 
. *Set up output file
. cap file close tablecontent
  3. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  4. 
. 
. use ./output/analysis_dataset.dta, clear
  5. 
. gen byte cons=1
  6. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
  7. file write tablecontent _n 
  8. 
. qui summarizevariable, variable(age) 
  9. file write tablecontent _n
 10. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 13. file write tablecontent _n 
 14. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. encode region, gen(region2)
 17. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 18. file write tablecontent _n 
 19. 
. file close tablecontent
 20. }
  7,857
  7,857
  16
  7,857
  3,987
  9
  7,857
  3,870
  7
  7,857
  1,186
  1
  7,857
  1,220
  1
  7,857
  1,153
  1
  7,857
  1,206
  4
  7,857
  1,133
  3
  7,857
  0
  0
  7,857
  5,486
  11
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  2
  7,857
  826
  3
  7,857
  815
  1
  7,857
  795
  1
  7,857
  1,566
  2
  7,857
  756
  3
  7,857
  798
  1
  7,857
  1,529
  5
  7,857
  770
  1
  7,857
  828
  2
(note: file ./output/Table1_positivetest.txt not found)
  7,857
  7,857
  17
  7,857
  3,987
  10
  7,857
  3,870
  7
  7,857
  1,186
  2
  7,857
  1,220
  2
  7,857
  1,153
  3
  7,857
  1,206
  1
  7,857
  1,133
  3
  7,857
  0
  0
  7,857
  5,486
  10
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  3
  7,857
  826
  4
  7,857
  815
  1
  7,857
  795
  4
  7,857
  1,566
  3
  7,857
  756
  1
  7,857
  798
  3
  7,857
  1,529
  2
  7,857
  770
  2
  7,857
  828
  1
(note: file ./output/Table1_icu.txt not found)
  7,857
  7,857
  16
  7,857
  3,987
  8
  7,857
  3,870
  8
  7,857
  1,186
  2
  7,857
  1,220
  1
  7,857
  1,153
  1
  7,857
  1,206
  1
  7,857
  1,133
  3
  7,857
  0
  0
  7,857
  5,486
  13
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  3
  7,857
  826
  0
  7,857
  815
  2
  7,857
  795
  2
  7,857
  1,566
  2
  7,857
  756
  1
  7,857
  798
  3
  7,857
  1,529
  3
  7,857
  770
  1
  7,857
  828
  2
(note: file ./output/Table1_hes.txt not found)
  7,857
  7,857
  1,065
  7,857
  3,987
  524
  7,857
  3,870
  541
  7,857
  1,186
  156
  7,857
  1,220
  170
  7,857
  1,153
  166
  7,857
  1,206
  169
  7,857
  1,133
  153
  7,857
  0
  0
  7,857
  5,486
  751
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  186
  7,857
  826
  128
  7,857
  815
  133
  7,857
  795
  105
  7,857
  1,566
  229
  7,857
  756
  102
  7,857
  798
  93
  7,857
  1,529
  178
  7,857
  770
  109
  7,857
  828
  116
(note: file ./output/Table1_onscoviddeath.txt not found)
  7,857
  7,857
  4
  7,857
  3,987
  1
  7,857
  3,870
  3
  7,857
  1,186
  0
  7,857
  1,220
  0
  7,857
  1,153
  1
  7,857
  1,206
  0
  7,857
  1,133
  2
  7,857
  0
  0
  7,857
  5,486
  2
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  2
  7,857
  826
  0
  7,857
  815
  0
  7,857
  795
  0
  7,857
  1,566
  1
  7,857
  756
  1
  7,857
  798
  1
  7,857
  1,529
  1
  7,857
  770
  0
  7,857
  828
  0
(note: file ./output/Table1_ons_noncoviddeath.txt not found)
  7,857
  7,857
  14
  7,857
  3,987
  8
  7,857
  3,870
  6
  7,857
  1,186
  3
  7,857
  1,220
  3
  7,857
  1,153
  3
  7,857
  1,206
  3
  7,857
  1,133
  0
  7,857
  0
  0
  7,857
  5,486
  8
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  4
  7,857
  826
  2
  7,857
  815
  1
  7,857
  795
  1
  7,857
  1,566
  3
  7,857
  756
  1
  7,857
  798
  3
  7,857
  1,529
  2
  7,857
  770
  1
  7,857
  828
  2
(note: file ./output/Table1_onsdeath.txt not found)
  7,857
  7,857
  18
  7,857
  3,987
  9
  7,857
  3,870
  9
  7,857
  1,186
  3
  7,857
  1,220
  3
  7,857
  1,153
  4
  7,857
  1,206
  3
  7,857
  1,133
  2
  7,857
  0
  0
  7,857
  5,486
  10
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  6
  7,857
  826
  2
  7,857
  815
  1
  7,857
  795
  1
  7,857
  1,566
  4
  7,857
  756
  2
  7,857
  798
  4
  7,857
  1,529
  3
  7,857
  770
  1
  7,857
  828
  2

. 
end of do-file

. do "/var/folders/jg/zvg1wn090ps86p3lwtn901140000gn/T//SD95913.000000"

. insheet using ./output/Table1_tested.txt
you must start with an empty dataset
r(18);

end of do-file

r(18);

. do "/var/folders/jg/zvg1wn090ps86p3lwtn901140000gn/T//SD95913.000000"

. insheet using ./output/Table1_tested.txt, clear
(9 vars, 25 obs)

. 
end of do-file

. bro

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("Table 1: Demographic and Clinical Characteristics
> - No care omes") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. qui summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. }
  7,857
  7,857
  16
  7,857
  3,987
  9
  7,857
  3,870
  7
  7,857
  1,186
  1
  7,857
  1,220
  1
  7,857
  1,153
  1
  7,857
  1,206
  4
  7,857
  1,133
  3
  7,857
  0
  0
  7,857
  5,486
  11
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  2
  7,857
  826
  3
  7,857
  815
  1
  7,857
  795
  1
  7,857
  1,566
  2
  7,857
  756
  3
  7,857
  798
  1
  7,857
  1,529
  5
  7,857
  770
  1
  7,857
  828
  2
  7,857
  7,857
  17
  7,857
  3,987
  10
  7,857
  3,870
  7
  7,857
  1,186
  2
  7,857
  1,220
  2
  7,857
  1,153
  3
  7,857
  1,206
  1
  7,857
  1,133
  3
  7,857
  0
  0
  7,857
  5,486
  10
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  3
  7,857
  826
  4
  7,857
  815
  1
  7,857
  795
  4
  7,857
  1,566
  3
  7,857
  756
  1
  7,857
  798
  3
  7,857
  1,529
  2
  7,857
  770
  2
  7,857
  828
  1
  7,857
  7,857
  16
  7,857
  3,987
  8
  7,857
  3,870
  8
  7,857
  1,186
  2
  7,857
  1,220
  1
  7,857
  1,153
  1
  7,857
  1,206
  1
  7,857
  1,133
  3
  7,857
  0
  0
  7,857
  5,486
  13
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  3
  7,857
  826
  0
  7,857
  815
  2
  7,857
  795
  2
  7,857
  1,566
  2
  7,857
  756
  1
  7,857
  798
  3
  7,857
  1,529
  3
  7,857
  770
  1
  7,857
  828
  2
  7,857
  7,857
  1,065
  7,857
  3,987
  524
  7,857
  3,870
  541
  7,857
  1,186
  156
  7,857
  1,220
  170
  7,857
  1,153
  166
  7,857
  1,206
  169
  7,857
  1,133
  153
  7,857
  0
  0
  7,857
  5,486
  751
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  186
  7,857
  826
  128
  7,857
  815
  133
  7,857
  795
  105
  7,857
  1,566
  229
  7,857
  756
  102
  7,857
  798
  93
  7,857
  1,529
  178
  7,857
  770
  109
  7,857
  828
  116
  7,857
  7,857
  4
  7,857
  3,987
  1
  7,857
  3,870
  3
  7,857
  1,186
  0
  7,857
  1,220
  0
  7,857
  1,153
  1
  7,857
  1,206
  0
  7,857
  1,133
  2
  7,857
  0
  0
  7,857
  5,486
  2
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  2
  7,857
  826
  0
  7,857
  815
  0
  7,857
  795
  0
  7,857
  1,566
  1
  7,857
  756
  1
  7,857
  798
  1
  7,857
  1,529
  1
  7,857
  770
  0
  7,857
  828
  0
  7,857
  7,857
  14
  7,857
  3,987
  8
  7,857
  3,870
  6
  7,857
  1,186
  3
  7,857
  1,220
  3
  7,857
  1,153
  3
  7,857
  1,206
  3
  7,857
  1,133
  0
  7,857
  0
  0
  7,857
  5,486
  8
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  4
  7,857
  826
  2
  7,857
  815
  1
  7,857
  795
  1
  7,857
  1,566
  3
  7,857
  756
  1
  7,857
  798
  3
  7,857
  1,529
  2
  7,857
  770
  1
  7,857
  828
  2
  7,857
  7,857
  18
  7,857
  3,987
  9
  7,857
  3,870
  9
  7,857
  1,186
  3
  7,857
  1,220
  3
  7,857
  1,153
  4
  7,857
  1,206
  3
  7,857
  1,133
  2
  7,857
  0
  0
  7,857
  5,486
  10
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  6
  7,857
  826
  2
  7,857
  815
  1
  7,857
  795
  1
  7,857
  1,566
  4
  7,857
  756
  2
  7,857
  798
  4
  7,857
  1,529
  3
  7,857
  770
  1
  7,857
  828
  2

. 
. insheet using ./output/Table1_tested.txt, clear
(9 vars, 27 obs)

. 
end of do-file

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("`outcome' characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. qui summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. }
  7,857
  7,857
  16
  7,857
  3,987
  9
  7,857
  3,870
  7
  7,857
  1,186
  1
  7,857
  1,220
  1
  7,857
  1,153
  1
  7,857
  1,206
  4
  7,857
  1,133
  3
  7,857
  0
  0
  7,857
  5,486
  11
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  2
  7,857
  826
  3
  7,857
  815
  1
  7,857
  795
  1
  7,857
  1,566
  2
  7,857
  756
  3
  7,857
  798
  1
  7,857
  1,529
  5
  7,857
  770
  1
  7,857
  828
  2
  7,857
  7,857
  17
  7,857
  3,987
  10
  7,857
  3,870
  7
  7,857
  1,186
  2
  7,857
  1,220
  2
  7,857
  1,153
  3
  7,857
  1,206
  1
  7,857
  1,133
  3
  7,857
  0
  0
  7,857
  5,486
  10
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  3
  7,857
  826
  4
  7,857
  815
  1
  7,857
  795
  4
  7,857
  1,566
  3
  7,857
  756
  1
  7,857
  798
  3
  7,857
  1,529
  2
  7,857
  770
  2
  7,857
  828
  1
  7,857
  7,857
  16
  7,857
  3,987
  8
  7,857
  3,870
  8
  7,857
  1,186
  2
  7,857
  1,220
  1
  7,857
  1,153
  1
  7,857
  1,206
  1
  7,857
  1,133
  3
  7,857
  0
  0
  7,857
  5,486
  13
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  3
  7,857
  826
  0
  7,857
  815
  2
  7,857
  795
  2
  7,857
  1,566
  2
  7,857
  756
  1
  7,857
  798
  3
  7,857
  1,529
  3
  7,857
  770
  1
  7,857
  828
  2
  7,857
  7,857
  1,065
  7,857
  3,987
  524
  7,857
  3,870
  541
  7,857
  1,186
  156
  7,857
  1,220
  170
  7,857
  1,153
  166
  7,857
  1,206
  169
  7,857
  1,133
  153
  7,857
  0
  0
  7,857
  5,486
  751
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  186
  7,857
  826
  128
  7,857
  815
  133
  7,857
  795
  105
  7,857
  1,566
  229
  7,857
  756
  102
  7,857
  798
  93
  7,857
  1,529
  178
  7,857
  770
  109
  7,857
  828
  116
  7,857
  7,857
  4
  7,857
  3,987
  1
  7,857
  3,870
  3
  7,857
  1,186
  0
  7,857
  1,220
  0
  7,857
  1,153
  1
  7,857
  1,206
  0
  7,857
  1,133
  2
  7,857
  0
  0
  7,857
  5,486
  2
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  2
  7,857
  826
  0
  7,857
  815
  0
  7,857
  795
  0
  7,857
  1,566
  1
  7,857
  756
  1
  7,857
  798
  1
  7,857
  1,529
  1
  7,857
  770
  0
  7,857
  828
  0
  7,857
  7,857
  14
  7,857
  3,987
  8
  7,857
  3,870
  6
  7,857
  1,186
  3
  7,857
  1,220
  3
  7,857
  1,153
  3
  7,857
  1,206
  3
  7,857
  1,133
  0
  7,857
  0
  0
  7,857
  5,486
  8
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  4
  7,857
  826
  2
  7,857
  815
  1
  7,857
  795
  1
  7,857
  1,566
  3
  7,857
  756
  1
  7,857
  798
  3
  7,857
  1,529
  2
  7,857
  770
  1
  7,857
  828
  2
  7,857
  7,857
  18
  7,857
  3,987
  9
  7,857
  3,870
  9
  7,857
  1,186
  3
  7,857
  1,220
  3
  7,857
  1,153
  4
  7,857
  1,206
  3
  7,857
  1,133
  2
  7,857
  0
  0
  7,857
  5,486
  10
  7,857
  0
  0
  7,857
  0
  0
  7,857
  1,545
  6
  7,857
  826
  2
  7,857
  815
  1
  7,857
  795
  1
  7,857
  1,566
  4
  7,857
  756
  2
  7,857
  798
  4
  7,857
  1,529
  3
  7,857
  770
  1
  7,857
  828
  2

. 
. insheet using ./output/Table1_tested.txt, clear
(9 vars, 27 obs)

. 
end of do-file

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
. 
.         qui summarize `variable', d
  5.         file write tablecontent ("Mean (SD)") _tab 
  6.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  7.         
.         forvalues i=0/1{                                                   
>      
  8.         qui summarize `variable' if `outcome' == `i', d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         }
 11. 
. file write tablecontent _n
 12. 
.         
.         qui summarize `variable', d
 13.         file write tablecontent ("Median (IQR)") _tab 
 14.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 15.         
.         forvalues i=0/1{
 16.         qui summarize `variable' if `outcome' == `i', d
 17.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 18.         }
 19.         
. file write tablecontent _n
 20.         
. end

. 
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("`outcome' characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. qui summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. }
  7,857
  7,857
  16
==0 invalid name
r(198);

end of do-file

r(198);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
. 
.         qui summarize `variable', d
  5.         file write tablecontent ("Mean (SD)") _tab 
  6.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  7.         
.         forvalues i=0/1 {                                                  
>      
  8.         qui summarize `variable' if `outcome' == `i', d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         }
 11. 
. file write tablecontent _n
 12. 
.         qui summarize `variable', d
 13.         file write tablecontent ("Median (IQR)") _tab 
 14.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 15.         
.         forvalues i=0/1 {
 16.         qui summarize `variable' if `outcome' == `i', d
 17.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 18.         }
 19.         
. file write tablecontent _n
 20.         
. end

. 
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("`outcome' characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. qui summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. }
  7,857
  7,857
  16
==0 invalid name
r(198);

end of do-file

r(198);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
. 
.         qui summarize `variable', d
  5.         file write tablecontent ("Mean (SD)") _tab 
  6.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  7.         
.         qui summarize `variable' if `outcome' == 1, d
  8.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  9.         }
 10. 
. file write tablecontent _n
 11. 
.         qui summarize `variable', d
 12.         file write tablecontent ("Median (IQR)") _tab 
 13.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 14.         
.         qui summarize `variable' if `outcome' == 1, d
 15.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 16.         }
 17.         
. file write tablecontent _n
 18.         
. end

. 
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("`outcome' characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. qui summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. }
  7,857
  7,857
  16
==1 invalid name
r(198);

end of do-file

r(198);

. set trace on

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
. 
.         qui summarize `variable', d
  5.         file write tablecontent ("Mean (SD)") _tab 
  6.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  7.         
.         qui summarize `variable' if `outcome' == 1, d
  8.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  9.         }
 10. 
. file write tablecontent _n
 11. 
.         qui summarize `variable', d
 12.         file write tablecontent ("Median (IQR)") _tab 
 13.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 14.         
.         qui summarize `variable' if `outcome' == 1, d
 15.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 16.         }
 17.         
. file write tablecontent _n
 18.         
. end

. 
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("`outcome' characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. qui summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. }
- foreach outcome of global outcomes {
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("tested characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label tested 0
- local lab2: label `outcome' 1
= local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- qui summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - qui summarize `variable', d
  = qui summarize age, d
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - qui summarize `variable' if `outcome' == 1, d
  = qui summarize age if  == 1, d
==1 invalid name
  ------------------------------------------------- end summarizevariable ---
  file write tablecontent _n
  tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
  file write tablecontent _n
  encode region, gen(region2)
  tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
  file write tablecontent _n
  file close tablecontent
  }
r(198);

end of do-file

r(198);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
. 
.         summarize `variable', d
  5.         file write tablecontent ("Mean (SD)") _tab 
  6.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  7.         
.         summarize `variable' if `outcome' == 1, d
  8.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  9.         }
 10. 
. file write tablecontent _n
 11. 
.         qui summarize `variable', d
 12.         file write tablecontent ("Median (IQR)") _tab 
 13.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 14.         
.         qui summarize `variable' if `outcome' == 1, d
 15.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 16.         }
 17.         
. file write tablecontent _n
 18.         
. end

. 
. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("`outcome' characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. qui summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. }
- foreach outcome of global outcomes {
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("tested characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label tested 0
- local lab2: label `outcome' 1
= local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- qui summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - summarize `variable', d
  = summarize age, d
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if `outcome' == 1, d
  = summarize age if  == 1, d
==1 invalid name
  ------------------------------------------------- end summarizevariable ---
  file write tablecontent _n
  tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
  file write tablecontent _n
  encode region, gen(region2)
  tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
  file write tablecontent _n
  file close tablecontent
  }
r(198);

end of do-file

r(198);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di `outcome'
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab 
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if `outcome' == 1, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         }
 11. 
. file write tablecontent _n
 12. 
.         qui summarize `variable', d
 13.         file write tablecontent ("Median (IQR)") _tab 
 14.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 15.         
.         qui summarize `variable' if `outcome' == 1, d
 16.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 17.         }
 18.         
. file write tablecontent _n
 19.         
. end

. 
. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("`outcome' characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. qui summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. }
- foreach outcome of global outcomes {
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("tested characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label tested 0
- local lab2: label `outcome' 1
= local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- qui summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di `outcome'
  = di 
  - summarize `variable', d
  = summarize age, d
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if `outcome' == 1, d
  = summarize age if  == 1, d
==1 invalid name
  ------------------------------------------------- end summarizevariable ---
  file write tablecontent _n
  tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
  file write tablecontent _n
  encode region, gen(region2)
  tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
  file write tablecontent _n
  file close tablecontent
  }
r(198);

end of do-file

r(198);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "`outcome'"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab 
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if `outcome' == 1, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         }
 11. 
. file write tablecontent _n
 12. 
.         qui summarize `variable', d
 13.         file write tablecontent ("Median (IQR)") _tab 
 14.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 15.         
.         qui summarize `variable' if `outcome' == 1, d
 16.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 17.         }
 18.         
. file write tablecontent _n
 19.         
. end

. 
. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("`outcome' characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. qui summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. }
- foreach outcome of global outcomes {
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("tested characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label tested 0
- local lab2: label `outcome' 1
= local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- qui summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""
  - summarize `variable', d
  = summarize age, d
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if `outcome' == 1, d
  = summarize age if  == 1, d
==1 invalid name
  ------------------------------------------------- end summarizevariable ---
  file write tablecontent _n
  tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
  file write tablecontent _n
  encode region, gen(region2)
  tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
  file write tablecontent _n
  file close tablecontent
  }
r(198);

end of do-file

r(198);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "`outcome'"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab 
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if `outcome'= 1, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         }
 11. 
. file write tablecontent _n
 12. 
.         qui summarize `variable', d
 13.         file write tablecontent ("Median (IQR)") _tab 
 14.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 15.         
.         qui summarize `variable' if `outcome' = 1, d
 16.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 17.         }
 18.         
. file write tablecontent _n
 19.         
. end

. 
. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("`outcome' characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. qui summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. }
- foreach outcome of global outcomes {
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("tested characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label tested 0
- local lab2: label `outcome' 1
= local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- qui summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""
  - summarize `variable', d
  = summarize age, d
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if `outcome'= 1, d
  = summarize age if = 1, d
=1 invalid name
  ------------------------------------------------- end summarizevariable ---
  file write tablecontent _n
  tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
  file write tablecontent _n
  encode region, gen(region2)
  tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
  file write tablecontent _n
  file close tablecontent
  }
r(198);

end of do-file

r(198);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "`outcome'"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab 
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if `outcome'== 1, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         }
 11. 
. file write tablecontent _n
 12. 
.         qui summarize `variable', d
 13.         file write tablecontent ("Median (IQR)") _tab 
 14.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 15.         
.         qui summarize `variable' if `outcome'== 1, d
 16.         file write tablecontent %3.1f (r(p50)) (" (") %3.1f (r(p25)) ("-
> ") %3.1f (r(p75)) (")") _tab
 17.         }
 18.         
. file write tablecontent _n
 19.         
. end

. 
. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("`outcome' characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. }
- foreach outcome of global outcomes {
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("tested characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label tested 0
- local lab2: label `outcome' 1
= local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if `outcome'== 1, d
  = summarize age if == 1, d
==1 invalid name
  ------------------------------------------------- end summarizevariable ---
  file write tablecontent _n
  tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
  file write tablecontent _n
  encode region, gen(region2)
  tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
  file write tablecontent _n
  file close tablecontent
  }
r(198);

end of do-file

r(198);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "`outcome'"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab 
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if `outcome'== 1, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         }
 11. 
. file write tablecontent _n      
 12. end

. 
. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("`outcome' characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. }
- foreach outcome of global outcomes {
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("tested characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label tested 0
- local lab2: label `outcome' 1
= local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if `outcome'== 1, d
  = summarize age if == 1, d
==1 invalid name
  ------------------------------------------------- end summarizevariable ---
  file write tablecontent _n
  tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
  file write tablecontent _n
  encode region, gen(region2)
  tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
  file write tablecontent _n
  file close tablecontent
  }
r(198);

end of do-file

r(198);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "`outcome'"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab 
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if tested== 1, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         }
 11. 
. file write tablecontent _n      
 12. end

. 
. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("`outcome' characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. }
- foreach outcome of global outcomes {
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("tested characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label tested 0
- local lab2: label `outcome' 1
= local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - }
} is not a valid command name
  ------------------------------------------------- end summarizevariable ---
  file write tablecontent _n
  tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
  file write tablecontent _n
  encode region, gen(region2)
  tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
  file write tablecontent _n
  file close tablecontent
  }
r(199);

end of do-file

r(199);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "`outcome'"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab 
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if tested== 1, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         
. 
. file write tablecontent _n      
 11. end

. 
. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("`outcome' characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. }
- foreach outcome of global outcomes {
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("tested characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label tested 0
- local lab2: label `outcome' 1
= local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
= tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
= tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
= tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
= tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_positivetest.txt, write text r
> eplace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("positivetest characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label positivetest 0
- local lab2: label `outcome' 1
= local lab2: label positivetest 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(positivetest)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & cons ==1
  17
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2163675703194604) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(positivete
> st)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
= tabulatevariable, variable(male) start(0) end(1) outcome(positivetest)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==0") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & male ==0
  10
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2508151492350138) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==1") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(positivete
> st)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
= tabulatevariable, variable(eth5) start(1) end(5) missing outcome(positivete
> st)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==1") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & eth5 ==1
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1686340640809443) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==2") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & eth5 ==2
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1639344262295082) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==3") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & eth5 ==3
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2601908065915005) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==4") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & eth5 ==4
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0829187396351575) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==5") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(pos
> itivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
= tabulatevariable, variable(imd) start(1) end(5) outcome(positivetest)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==1") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & imd ==1
  10
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1822821728034998) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==2") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==3") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==4") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & imd ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1941747572815534) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==5") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & imd ==5
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.4842615012106538) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(positivetes
> t)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
= tabulatevariable, variable(region2) start(1) end(8) outcome(positivetest)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==1") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==2") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==2
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.5031446540880503) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==3") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==3
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1915708812260536) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==4") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==4
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1322751322751323) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==5") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3759398496240601) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==6") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==6
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1308044473512099) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==7") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==7
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2597402597402597) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==8") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==8
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1207729468599034) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(positiv
> etest)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_icu.txt, write text replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("icu characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label icu 0
- local lab2: label `outcome' 1
= local lab2: label icu 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(icu)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(icu)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
= tabulatevariable, variable(male) start(0) end(1) outcome(icu)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==0") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & male ==0
  8
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.200652119388011) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==1") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & male ==1
  8
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.20671834625323) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(icu)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
= tabulatevariable, variable(eth5) start(1) end(5) missing outcome(icu)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==1") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & eth5 ==1
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1686340640809443) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==2") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==3") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==4") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & eth5 ==4
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0829187396351575) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==5") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(icu
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
= tabulatevariable, variable(imd) start(1) end(5) outcome(icu)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==1") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & imd ==1
  13
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2369668246445498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==2") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==3") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==4") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & imd ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1941747572815534) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==5") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & imd ==5
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(icu)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
= tabulatevariable, variable(region2) start(1) end(8) outcome(icu)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==1") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==1
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.245398773006135) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==2") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==2
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2515723270440252) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==3") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==4") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==4
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1322751322751323) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==5") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3759398496240601) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==6") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==6
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1962066710268149) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==7") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==8") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(icu)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_hes.txt, write text replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("hes characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label hes 0
- local lab2: label `outcome' 1
= local lab2: label hes 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(hes)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & cons ==1
  1,065
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.55479190530737) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(hes)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
= tabulatevariable, variable(male) start(0) end(1) outcome(hes)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==0") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & male ==0
  524
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.14271381991472) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==1") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & male ==1
  541
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.97932816537468) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(hes)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
= tabulatevariable, variable(eth5) start(1) end(5) missing outcome(hes)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==1") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & eth5 ==1
  156
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.15345699831366) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==2") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & eth5 ==2
  170
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.9344262295082) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==3") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & eth5 ==3
  166
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (14.39722463139636) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==4") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & eth5 ==4
  169
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (14.01326699834163) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==5") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & eth5 ==5
  153
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.50397175639894) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(hes
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
= tabulatevariable, variable(imd) start(1) end(5) outcome(hes)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==1") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & imd ==1
  751
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.68939117754284) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==2") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==3") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==4") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & imd ==4
  186
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (12.03883495145631) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==5") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & imd ==5
  128
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (15.49636803874092) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(hes)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
= tabulatevariable, variable(region2) start(1) end(8) outcome(hes)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==1") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==1
  133
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (16.31901840490798) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==2") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==2
  105
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.20754716981132) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==3") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==3
  229
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (14.62324393358876) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==4") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==4
  102
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.49206349206349) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==5") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==5
  93
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (11.65413533834586) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==6") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==6
  178
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (11.64159581425769) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==7") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==7
  109
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (14.15584415584416) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==8") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==8
  116
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (14.00966183574879) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(hes)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_onscoviddeath.txt, write text 
> replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("onscoviddeath characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label onscoviddeath 0
- local lab2: label `outcome' 1
= local lab2: label onscoviddeath 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(onscoviddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & cons ==1
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0509100165457554) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(onscovidde
> ath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
= tabulatevariable, variable(male) start(0) end(1) outcome(onscoviddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==0") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & male ==0
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0250815149235014) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==1") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & male ==1
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0775193798449612) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(onscovidde
> ath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
= tabulatevariable, variable(eth5) start(1) end(5) missing outcome(onscovidde
> ath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==1") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & eth5 ==1
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==2") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & eth5 ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==3") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==4") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & eth5 ==4
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==5") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & eth5 ==5
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.176522506619594) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(ons
> coviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
= tabulatevariable, variable(imd) start(1) end(5) outcome(onscoviddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==1") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & imd ==1
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0364564345607) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==2") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==3") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==4") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==5") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & imd ==5
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(onscoviddea
> th)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
= tabulatevariable, variable(region2) start(1) end(8) outcome(onscoviddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==1") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==1
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==2") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==3") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0638569604086845) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==4") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==4
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1322751322751323) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==5") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==6") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==6
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.065402223675605) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==7") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==7
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==8") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==8
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(onscovi
> ddeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_ons_noncoviddeath.txt, write t
> ext replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("ons_noncoviddeath characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label ons_noncoviddeath 0
- local lab2: label `outcome' 1
= local lab2: label ons_noncoviddeath 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(ons_noncoviddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & cons ==1
  14
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1781850579101438) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(ons_noncov
> iddeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
= tabulatevariable, variable(male) start(0) end(1) outcome(ons_noncoviddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==0") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & male ==0
  8
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.200652119388011) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==1") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & male ==1
  6
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1550387596899225) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(ons_noncov
> iddeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
= tabulatevariable, variable(eth5) start(1) end(5) missing outcome(ons_noncov
> iddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==1") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & eth5 ==1
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2529510961214165) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==2") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & eth5 ==2
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2459016393442623) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==3") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & eth5 ==3
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2601908065915005) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==4") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & eth5 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2487562189054726) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==5") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & eth5 ==5
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(ons
> _noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
= tabulatevariable, variable(imd) start(1) end(5) outcome(ons_noncoviddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==1") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & imd ==1
  8
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1458257382427998) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==2") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==3") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==4") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & imd ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2588996763754045) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==5") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & imd ==5
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2421307506053269) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(ons_noncovi
> ddeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
= tabulatevariable, variable(region2) start(1) end(8) outcome(ons_noncoviddea
> th)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==1") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==2") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==3") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==3
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1915708812260536) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==4") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==4
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1322751322751323) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==5") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3759398496240601) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==6") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==6
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1308044473512099) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==7") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==8") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(ons_non
> coviddeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_onsdeath.txt, write text repla
> ce
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("onsdeath characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label onsdeath 0
- local lab2: label `outcome' 1
= local lab2: label onsdeath 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(onsdeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & cons ==1
  18
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2290950744558992) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(onsdeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
= tabulatevariable, variable(male) start(0) end(1) outcome(onsdeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==0") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==1") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & male ==1
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2325581395348837) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(onsdeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
= tabulatevariable, variable(eth5) start(1) end(5) missing outcome(onsdeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==1") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & eth5 ==1
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2529510961214165) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==2") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & eth5 ==2
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2459016393442623) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==3") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & eth5 ==3
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3469210754553339) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==4") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & eth5 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2487562189054726) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==5") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & eth5 ==5
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.176522506619594) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(ons
> death)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
= tabulatevariable, variable(imd) start(1) end(5) outcome(onsdeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==1") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & imd ==1
  10
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1822821728034998) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==2") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==3") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==4") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & imd ==4
  6
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3883495145631068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==5") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & imd ==5
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2421307506053269) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(onsdeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
= tabulatevariable, variable(region2) start(1) end(8) outcome(onsdeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==1") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==2") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==3") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==3
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2554278416347382) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==4") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2645502645502645) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==5") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==5
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.5012531328320802) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==6") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==6
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1962066710268149) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==7") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==8") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(onsdeat
> h)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- }

. 
. insheet using ./output/Table1_tested.txt, clear
(4 vars, 26 obs)

. 
end of do-file

. bro

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "`outcome'"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab 
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if tested== 1, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         
. 
. file write tablecontent _n      
 11. end

. 
. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("`outcome' characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. di "`outcome'"
 25. }
- foreach outcome of global outcomes {
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("tested characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label tested 0
- local lab2: label `outcome' 1
= local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
= tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
= tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
= tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
= tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- di "`outcome'"
= di "tested"
tested
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_positivetest.txt, write text r
> eplace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("positivetest characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label positivetest 0
- local lab2: label `outcome' 1
= local lab2: label positivetest 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(positivetest)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & cons ==1
  17
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2163675703194604) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(positivete
> st)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
= tabulatevariable, variable(male) start(0) end(1) outcome(positivetest)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==0") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & male ==0
  10
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2508151492350138) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==1") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(positivete
> st)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
= tabulatevariable, variable(eth5) start(1) end(5) missing outcome(positivete
> st)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==1") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & eth5 ==1
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1686340640809443) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==2") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & eth5 ==2
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1639344262295082) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==3") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & eth5 ==3
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2601908065915005) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==4") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & eth5 ==4
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0829187396351575) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==5") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(pos
> itivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
= tabulatevariable, variable(imd) start(1) end(5) outcome(positivetest)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==1") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & imd ==1
  10
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1822821728034998) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==2") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==3") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==4") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & imd ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1941747572815534) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==5") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & imd ==5
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.4842615012106538) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(positivetes
> t)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
= tabulatevariable, variable(region2) start(1) end(8) outcome(positivetest)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==1") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==2") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==2
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.5031446540880503) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==3") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==3
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1915708812260536) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==4") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==4
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1322751322751323) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==5") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3759398496240601) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==6") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==6
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1308044473512099) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==7") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==7
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2597402597402597) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==8") outcome(positivetest)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if positivetest==1 & region2 ==8
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1207729468599034) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(positiv
> etest)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- di "`outcome'"
= di "positivetest"
positivetest
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_icu.txt, write text replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("icu characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label icu 0
- local lab2: label `outcome' 1
= local lab2: label icu 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(icu)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(icu)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
= tabulatevariable, variable(male) start(0) end(1) outcome(icu)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==0") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & male ==0
  8
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.200652119388011) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==1") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & male ==1
  8
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.20671834625323) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(icu)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
= tabulatevariable, variable(eth5) start(1) end(5) missing outcome(icu)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==1") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & eth5 ==1
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1686340640809443) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==2") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==3") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==4") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & eth5 ==4
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0829187396351575) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==5") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(icu
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
= tabulatevariable, variable(imd) start(1) end(5) outcome(icu)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==1") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & imd ==1
  13
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2369668246445498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==2") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==3") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==4") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & imd ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1941747572815534) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==5") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & imd ==5
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(icu)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
= tabulatevariable, variable(region2) start(1) end(8) outcome(icu)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==1") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==1
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.245398773006135) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==2") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==2
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2515723270440252) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==3") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==4") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==4
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1322751322751323) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==5") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3759398496240601) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==6") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==6
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1962066710268149) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==7") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==8") outcome(icu)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if icu==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(icu)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- di "`outcome'"
= di "icu"
icu
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_hes.txt, write text replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("hes characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label hes 0
- local lab2: label `outcome' 1
= local lab2: label hes 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(hes)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & cons ==1
  1,065
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.55479190530737) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(hes)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
= tabulatevariable, variable(male) start(0) end(1) outcome(hes)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==0") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & male ==0
  524
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.14271381991472) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==1") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & male ==1
  541
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.97932816537468) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(hes)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
= tabulatevariable, variable(eth5) start(1) end(5) missing outcome(hes)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==1") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & eth5 ==1
  156
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.15345699831366) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==2") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & eth5 ==2
  170
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.9344262295082) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==3") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & eth5 ==3
  166
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (14.39722463139636) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==4") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & eth5 ==4
  169
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (14.01326699834163) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==5") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & eth5 ==5
  153
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.50397175639894) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(hes
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
= tabulatevariable, variable(imd) start(1) end(5) outcome(hes)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==1") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & imd ==1
  751
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.68939117754284) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==2") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==3") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==4") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & imd ==4
  186
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (12.03883495145631) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==5") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & imd ==5
  128
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (15.49636803874092) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(hes)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
= tabulatevariable, variable(region2) start(1) end(8) outcome(hes)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==1") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==1
  133
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (16.31901840490798) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==2") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==2
  105
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.20754716981132) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==3") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==3
  229
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (14.62324393358876) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==4") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==4
  102
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (13.49206349206349) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==5") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==5
  93
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (11.65413533834586) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==6") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==6
  178
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (11.64159581425769) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==7") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==7
  109
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (14.15584415584416) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==8") outcome(hes)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if hes==1 & region2 ==8
  116
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (14.00966183574879) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(hes)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- di "`outcome'"
= di "hes"
hes
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_onscoviddeath.txt, write text 
> replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("onscoviddeath characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label onscoviddeath 0
- local lab2: label `outcome' 1
= local lab2: label onscoviddeath 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(onscoviddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & cons ==1
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0509100165457554) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(onscovidde
> ath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
= tabulatevariable, variable(male) start(0) end(1) outcome(onscoviddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==0") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & male ==0
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0250815149235014) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==1") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & male ==1
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0775193798449612) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(onscovidde
> ath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
= tabulatevariable, variable(eth5) start(1) end(5) missing outcome(onscovidde
> ath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==1") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & eth5 ==1
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==2") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & eth5 ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==3") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==4") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & eth5 ==4
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==5") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & eth5 ==5
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.176522506619594) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(ons
> coviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
= tabulatevariable, variable(imd) start(1) end(5) outcome(onscoviddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==1") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & imd ==1
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0364564345607) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==2") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==3") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==4") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==5") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & imd ==5
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(onscoviddea
> th)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
= tabulatevariable, variable(region2) start(1) end(8) outcome(onscoviddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==1") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==1
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==2") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==3") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0638569604086845) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==4") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==4
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1322751322751323) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==5") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==6") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==6
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.065402223675605) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==7") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==7
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==8") outcome(onscoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onscoviddeath==1 & region2 ==8
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(onscovi
> ddeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- di "`outcome'"
= di "onscoviddeath"
onscoviddeath
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_ons_noncoviddeath.txt, write t
> ext replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("ons_noncoviddeath characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label ons_noncoviddeath 0
- local lab2: label `outcome' 1
= local lab2: label ons_noncoviddeath 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(ons_noncoviddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & cons ==1
  14
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1781850579101438) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(ons_noncov
> iddeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
= tabulatevariable, variable(male) start(0) end(1) outcome(ons_noncoviddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==0") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & male ==0
  8
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.200652119388011) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==1") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & male ==1
  6
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1550387596899225) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(ons_noncov
> iddeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
= tabulatevariable, variable(eth5) start(1) end(5) missing outcome(ons_noncov
> iddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==1") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & eth5 ==1
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2529510961214165) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==2") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & eth5 ==2
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2459016393442623) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==3") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & eth5 ==3
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2601908065915005) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==4") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & eth5 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2487562189054726) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==5") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & eth5 ==5
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (0) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(ons
> _noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
= tabulatevariable, variable(imd) start(1) end(5) outcome(ons_noncoviddeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==1") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & imd ==1
  8
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1458257382427998) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==2") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==3") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==4") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & imd ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2588996763754045) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==5") outcome(ons_noncoviddeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & imd ==5
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2421307506053269) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(ons_noncovi
> ddeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
= tabulatevariable, variable(region2) start(1) end(8) outcome(ons_noncoviddea
> th)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==1") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==2") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==3") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==3
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1915708812260536) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==4") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==4
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1322751322751323) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==5") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3759398496240601) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==6") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==6
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1308044473512099) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==7") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==8") outcome(ons_noncoviddeath
> )
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if ons_noncoviddeath==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(ons_non
> coviddeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- di "`outcome'"
= di "ons_noncoviddeath"
ons_noncoviddeath
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_onsdeath.txt, write text repla
> ce
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("onsdeath characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label onsdeath 0
- local lab2: label `outcome' 1
= local lab2: label onsdeath 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(onsdeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & cons ==1
  18
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2290950744558992) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(onsdeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
= tabulatevariable, variable(male) start(0) end(1) outcome(onsdeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==0") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(male) condition("==1") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & male ==1
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2325581395348837) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(onsdeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
= tabulatevariable, variable(eth5) start(1) end(5) missing outcome(onsdeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==1") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & eth5 ==1
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2529510961214165) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==2") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & eth5 ==2
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2459016393442623) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==3") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & eth5 ==3
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3469210754553339) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==4") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & eth5 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2487562189054726) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(eth5) condition("==5") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & eth5 ==5
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.176522506619594) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(ons
> death)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
= tabulatevariable, variable(imd) start(1) end(5) outcome(onsdeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==1") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & imd ==1
  10
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1822821728034998) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==2") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==3") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==4") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & imd ==4
  6
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3883495145631068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(imd) condition("==5") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & imd ==5
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2421307506053269) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(onsdeath)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
= tabulatevariable, variable(region2) start(1) end(8) outcome(onsdeath)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==1") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==2") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==3") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==3
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2554278416347382) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==4") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2645502645502645) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==5") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==5
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.5012531328320802) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==6") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==6
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1962066710268149) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==7") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(region2) condition("==8") outcome(onsdeath)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if onsdeath==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(onsdeat
> h)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- di "`outcome'"
= di "onsdeath"
onsdeath
- }

. 
. insheet using ./output/Table1_tested.txt, clear
(4 vars, 26 obs)

. 
end of do-file

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_outcome_characteristics.do"

. *compare characteristics of people with each outcome
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. global outcomes "tested positivetest icu hes onscoviddeath ons_noncoviddeat
> h onsdeath"

. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if `outcome'==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(`outcome')
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(`outcome')
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "`outcome'"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab 
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if `outcome'== 1, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         
. 
. file write tablecontent _n      
 11. end

. 
. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_`outcome'.txt, write text r
> eplace
  5. 
. file write tablecontent ("`outcome' characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label `outcome' 0
  7. local lab2: label `outcome' 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
 11. file write tablecontent _n 
 12. 
. summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. di "`outcome'"
 25. }
- foreach outcome of global outcomes {
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_`outcome'.txt, write text repl
> ace
= file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("`outcome' characteristics") _n
= file write tablecontent ("tested characteristics") _n
- local lab1: label `outcome' 0
= local lab1: label tested 0
- local lab2: label `outcome' 1
= local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(`outcome')
= tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(`outc
> ome')
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if `outcome'==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(`outcome')
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "`outcome'"
  = di ""

  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if `outcome'== 1, d
  = summarize age if == 1, d
==1 invalid name
  ------------------------------------------------- end summarizevariable ---
  file write tablecontent _n
  tabulatevariable, variable(male) start(0) end(1) outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(eth5) start(1) end(5) missing outcome(`outcome')
  file write tablecontent _n
  tabulatevariable, variable(imd) start(1) end(5) outcome(`outcome')
  file write tablecontent _n
  encode region, gen(region2)
  tabulatevariable, variable(region2) start(1) end(8) outcome(`outcome')
  file write tablecontent _n
  file close tablecontent
  di "`outcome'"
  }
r(198);

end of do-file

r(198);

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_tested_characteristics.do"

. *compare characteristics of people with a test
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if tested==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(tested)
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(tested)
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "tested"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab 
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if tested== 1, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         
. 
. file write tablecontent _n      
 11. end

. 
. 
. foreach outcome of global outcomes {
  2. use ./output/analysis_dataset.dta, clear
  3. 
. *Set up output file
. cap file close tablecontent
  4. file open tablecontent using ./output/Table1_tested.txt, write text repl
> ace
  5. 
. file write tablecontent ("tested characteristics") _n
  6. 
. *  labelled columns
. 
. local lab1: label tested 0
  7. local lab2: label tested 1
  8. 
. 
. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    
  9. 
. 
. gen byte cons=1
 10. tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
 11. file write tablecontent _n 
 12. 
. summarizevariable, variable(age) 
 13. file write tablecontent _n
 14. 
. tabulatevariable, variable(male) start(0) end(1) outcome(tested)
 15. file write tablecontent _n 
 16. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
 17. file write tablecontent _n 
 18. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
 19. file write tablecontent _n 
 20. 
. encode region, gen(region2)
 21. tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
 22. file write tablecontent _n 
 23. 
. file close tablecontent
 24. di "tested"
 25. }
- foreach outcome of global outcomes {
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("tested characteristics") _n
- local lab1: label tested 0
- local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "tested"
tested
  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- di "tested"
tested
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("tested characteristics") _n
- local lab1: label tested 0
- local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "tested"
tested
  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- di "tested"
tested
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("tested characteristics") _n
- local lab1: label tested 0
- local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "tested"
tested
  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- di "tested"
tested
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("tested characteristics") _n
- local lab1: label tested 0
- local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "tested"
tested
  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- di "tested"
tested
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("tested characteristics") _n
- local lab1: label tested 0
- local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "tested"
tested
  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- di "tested"
tested
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("tested characteristics") _n
- local lab1: label tested 0
- local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "tested"
tested
  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- di "tested"
tested
- }
- use ./output/analysis_dataset.dta, clear
- cap file close tablecontent
- file open tablecontent using ./output/Table1_tested.txt, write text replace
- file write tablecontent ("tested characteristics") _n
- local lab1: label tested 0
- local lab2: label tested 1
- file write tablecontent _tab ("Total") _tab ("`lab1'") _tab ("`lab2'") _n
= file write tablecontent _tab ("Total") _tab ("0") _tab ("1") _n
- gen byte cons=1
- tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- summarizevariable, variable(age)
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "tested"
tested
  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---
- file write tablecontent _n
- tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- encode region, gen(region2)
- tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---
- file write tablecontent _n
- file close tablecontent
- di "tested"
tested
- }

. 
. insheet using ./output/Table1_tested.txt, clear
(4 vars, 26 obs)

. 
end of do-file

. bro

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_tested_characteristics.do"

. *compare characteristics of people with a test
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9. 
.         cou if tested==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(tested)
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(tested)
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "tested"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab 
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if tested== 0, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10. 
.         
.         summarize `variable' if tested== 1, d
 11.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 12.         
. 
. file write tablecontent _n      
 13. end

. 
. use ./output/analysis_dataset.dta, clear

. 
. *Set up output file
. cap file close tablecontent

. file open tablecontent using ./output/Table1_tested.txt, write text replace

. 
. file write tablecontent ("tested characteristics") _n

. 
. *  labelled columns
. 
. local lab1: label tested 0

. local lab2: label tested 1

. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    

. 
. 
. gen byte cons=1

. tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. summarizevariable, variable(age) 
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "tested"
tested
  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 0, d
  = summarize age if tested== 0, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,841
25%           33             18       Sum of Wgt.       7,841

50%           48                      Mean            48.7675
                        Largest       Std. Dev.      18.95027
75%           63             99
90%           75             99       Variance       359.1126
95%           82             99       Skewness       .2685671
99%           91            103       Kurtosis       2.157757
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---

. file write tablecontent _n

. 
. tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. encode region, gen(region2)

. tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. file close tablecontent

. di "tested"
tested

. 
. insheet using ./output/Table1_tested.txt, clear
(5 vars, 26 obs)

. 
end of do-file

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_tested_characteristics.do"

. *compare characteristics of people with a test
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9.         
.         cou if tested==0 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
. 
.         cou if tested==1 & `variable' `condition'
 13.         local pct = 100*(r(N)/`rowdenom')
 14.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 15. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(tested)
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(tested)
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "tested"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab 
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if tested== 0, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10. 
.         
.         summarize `variable' if tested== 1, d
 11.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 12.         
. 
. file write tablecontent _n      
 13. end

. 
. use ./output/analysis_dataset.dta, clear

. 
. *Set up output file
. cap file close tablecontent

. file open tablecontent using ./output/Table1_tested.txt, write text replace

. 
. file write tablecontent ("tested characteristics") _n

. 
. *  labelled columns
. 
. local lab1: label tested 0

. local lab2: label tested 1

. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    

. 
. 
. gen byte cons=1

. tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & cons ==1
  7,841
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.79635993381699) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. summarizevariable, variable(age) 
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "tested"
tested
  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 0, d
  = summarize age if tested== 0, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,841
25%           33             18       Sum of Wgt.       7,841

50%           48                      Mean            48.7675
                        Largest       Std. Dev.      18.95027
75%           63             99
90%           75             99       Variance       359.1126
95%           82             99       Skewness       .2685671
99%           91            103       Kurtosis       2.157757
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---

. file write tablecontent _n

. 
. tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & male ==0
  3,978
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.77426636568849) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & male ==1
  3,863
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.81912144702842) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & eth5 ==1
  1,185
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.91568296795953) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & eth5 ==2
  1,219
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.91803278688525) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & eth5 ==3
  1,152
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.91326973113617) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & eth5 ==4
  1,202
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.66832504145937) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & eth5 ==5
  1,130
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.73521624007061) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & imd ==1
  5,475
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.79948960991615) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & imd ==4
  1,543
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.8705501618123) (")") _n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & imd ==5
  823
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.63680387409201) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. encode region, gen(region2)

. tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & region2 ==1
  814
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.87730061349693) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & region2 ==2
  794
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.87421383647799) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & region2 ==3
  1,564
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.87228607918263) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & region2 ==4
  753
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.60317460317461) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & region2 ==5
  797
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.87468671679198) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & region2 ==6
  1,524
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.67298888162198) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & region2 ==7
  769
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.87012987012987) (")") _
> n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if tested==0 & `variable' `condition'
    = cou if tested==0 & region2 ==8
  826
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (99.7584541062802) (")") _n
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. file close tablecontent

. di "tested"
tested

. 
. insheet using ./output/Table1_tested.txt, clear
(5 vars, 48 obs)

. 
end of do-file

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_tested_characteristics.do"

. *compare characteristics of people with a test
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9.         
.         cou if tested==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(tested)
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(tested)
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "tested"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab 
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if tested== 1, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         
. 
. file write tablecontent _n      
 11. end

. 
. use ./output/analysis_dataset.dta, clear

. 
. *Set up output file
. cap file close tablecontent

. file open tablecontent using ./output/Table1_tested.txt, write text replace

. 
. file write tablecontent ("tested characteristics") _n

. 
. *  labelled columns
. 
. local lab1: label tested 0

. local lab2: label tested 1

. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _tab ///
>                                                          ("`lab2'")        
>                                        _n                                  
>                    

. 
. 
. gen byte cons=1

. tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. summarizevariable, variable(age) 
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "tested"
tested
  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---

. file write tablecontent _n

. 
. tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. encode region, gen(region2)

. tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. file close tablecontent

. di "tested"
tested

. 
. insheet using ./output/Table1_tested.txt, clear
(4 vars, 26 obs)

. 
end of do-file

. do "/var/folders/jg/zvg1wn090ps86p3lwtn901140000gn/T//SD95913.000000"

. local lab1: label tested 1

. 
end of do-file

. do "/var/folders/jg/zvg1wn090ps86p3lwtn901140000gn/T//SD95913.000000"

. local lab1: label tested 1

. 
end of do-file

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_tested_characteristics.do"

. *compare characteristics of people with a test
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9.         
.         cou if tested==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(tested)
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(tested)
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "tested"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab 
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if tested== 1, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         
. 
. file write tablecontent _n      
 11. end

. 
. use ./output/analysis_dataset.dta, clear

. 
. *Set up output file
. cap file close tablecontent

. file open tablecontent using ./output/Table1_tested.txt, write text replace

. 
. file write tablecontent ("tested characteristics") _n

. 
. *  labelled columns
. 
. local lab1: label tested 1

. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _n

. 
. gen byte cons=1

. tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. summarizevariable, variable(age) 
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "tested"
tested
  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---

. file write tablecontent _n

. 
. tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. encode region, gen(region2)

. tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. file close tablecontent

. di "tested"
tested

. 
. insheet using ./output/Table1_tested.txt, clear
(4 vars, 26 obs)

. 
end of do-file

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_tested_characteristics.do"

. *compare characteristics of people with a test
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9.         
.         cou if tested==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(tested)
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(tested)
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "tested"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab _tab
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if tested== 1, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         
. 
. file write tablecontent _n      
 11. end

. 
. use ./output/analysis_dataset.dta, clear

. 
. *Set up output file
. cap file close tablecontent

. file open tablecontent using ./output/Table1_tested.txt, write text replace

. 
. file write tablecontent ("tested characteristics") _n

. 
. *  labelled columns
. 
. local lab1: label tested 1

. 
. file write tablecontent _tab ("Total")                                     
>                _tab ///
>                                                          ("`lab1'")        
>                                        _n

. 
. gen byte cons=1

. tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. summarizevariable, variable(age) 
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "tested"
tested
  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---

. file write tablecontent _n

. 
. tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. encode region, gen(region2)

. tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. file close tablecontent

. di "tested"
tested

. 
. insheet using ./output/Table1_tested.txt, clear
(5 vars, 26 obs)

. 
end of do-file

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_tested_characteristics.do"

. *compare characteristics of people with a test
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9.         
.         cou if tested==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(tested)
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(tested)
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "tested"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab _tab
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if tested== 1, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         
. 
. file write tablecontent _n      
 11. end

. 
. use ./output/analysis_dataset.dta, clear

. 
. *Set up output file
. cap file close tablecontent

. file open tablecontent using ./output/Table1_tested.txt, write text replace

. 
. file write tablecontent ("tested characteristics") _n

. 
. *  labelled columns
. 
. local lab1: label tested 1

. 
. file write tablecontent _tab ("Category") _tab ("Total")  _tab ///
>                                                          ("`lab1'")        
>                                        _n

. 
. gen byte cons=1

. tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. summarizevariable, variable(age) 
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "tested"
tested
  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---

. file write tablecontent _n

. 
. tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. encode region, gen(region2)

. tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. file close tablecontent

. di "tested"
tested

. 
. insheet using ./output/Table1_tested.txt, clear
(5 vars, 26 obs)

. 
end of do-file

. do "/Users/lsh152058/Documents/GitHub/ethnicity-covid-research/analysis/21_
> eth_tested_characteristics.do"

. *compare characteristics of people with a test
. *************************************************************************
. *Purpose: Create content that is ready to paste into a pre-formatted Word 
. * shell "Table 1" (main cohort descriptives) for the Risk Factors paper
. *
. *Requires: final analysis dataset (cr_analysis_dataset.dta)
. *
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 17/4/2020
. *************************************************************************
. 
. ***************************************************************************
> ****
. *Generic code to output one row of table
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) outcome(string)
  2.         
.         *put the varname and condition to left so that alignment can be che
> cked vs shell
.         file write tablecontent ("`variable'") _tab ("`condition'") _tab
  3.         
.         cou
  4.         local overalldenom=r(N)
  5.         
.         cou if `variable' `condition'
  6.         local rowdenom = r(N)
  7.         local colpct = 100*(r(N)/`overalldenom')
  8.         file write tablecontent (`rowdenom')  (" (") %3.1f (`colpct') ("
> )") _tab
  9.         
.         cou if tested==1 & `variable' `condition'
 10.         local pct = 100*(r(N)/`rowdenom')
 11.         file write tablecontent (r(N)) (" (") %4.2f  (`pct') (")") _n
 12. 
.         
. end

. 
. ***************************************************************************
> ****
. *Generic code to output one section (varible) within table (calls above)
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) start(real) end(real) [missing] outcome(string
> )
  2. 
.         foreach varlevel of numlist `start'/`end'{ 
  3.                 generaterow, variable(`variable') condition("==`varlevel
> '") outcome(tested)
  4.         }
  5.         if "`missing'"!="" generaterow, variable(`variable') condition("
> >=.") outcome(tested)
  6. 
. end

. 
. ***************************************************************************
> ****
. 
. ***************************************************************************
> *****
. * Generic code to qui summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         di "tested"
  5.         summarize `variable', d
  6.         file write tablecontent ("Mean (SD)") _tab _tab
  7.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
  8.         
.         summarize `variable' if tested== 1, d
  9.         file write tablecontent  %3.1f (r(mean)) (" (") %3.1f (r(sd)) ("
> )") _tab
 10.         
. 
. file write tablecontent _n      
 11. end

. 
. use ./output/analysis_dataset.dta, clear

. 
. *Set up output file
. cap file close tablecontent

. file open tablecontent using ./output/Table1_tested.txt, write text replace

. 
. file write tablecontent ("tested characteristics") _n

. 
. *  labelled columns
. 
. local lab1: label tested 1

. 
. file write tablecontent _tab ("Category") _tab ("Total")  _tab ///
>                                                          ("`lab1'")        
>                                        _n

. 
. gen byte cons=1

. tabulatevariable, variable(cons) start(1) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(cons) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("cons") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if cons ==1
  7,857
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (7857) (" (") %3.1f (100) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & cons ==1
  16
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/7857)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2036400661830215) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(cons) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. summarizevariable, variable(age) 
  ----------------------------------------------- begin summarizevariable ---
  - syntax, variable(varname)
  - local lab: variable label `variable'
  = local lab: variable label age
  - file write tablecontent ("`lab'") _n
  = file write tablecontent ("Age (years)") _n
  - di "tested"
tested
  - summarize `variable', d
  = summarize age, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           18             18
 5%           21             18
10%           24             18       Obs               7,857
25%           33             18       Sum of Wgt.       7,857

50%           48                      Mean           48.74978
                        Largest       Std. Dev.      18.94281
75%           63             99
90%           75             99       Variance       358.8299
95%           82             99       Skewness       .2697712
99%           91            103       Kurtosis       2.159501
  - file write tablecontent ("Mean (SD)") _tab _tab
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - summarize `variable' if tested== 1, d
  = summarize age if tested== 1, d

                         Age (years)
-------------------------------------------------------------
      Percentiles      Smallest
 1%           23             23
 5%           23             23
10%           23             23       Obs                  16
25%           29             29       Sum of Wgt.          16

50%           42                      Mean            40.0625
                        Largest       Std. Dev.      12.42293
75%         50.5             52
90%           57             53       Variance       154.3292
95%           58             57       Skewness      -.0832123
99%           58             58       Kurtosis       1.597093
  - file write tablecontent %3.1f (r(mean)) (" (") %3.1f (r(sd)) (")") _tab
  - file write tablecontent _n
  ------------------------------------------------- end summarizevariable ---

. file write tablecontent _n

. 
. tabulatevariable, variable(male) start(0) end(1) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 0/1{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==0") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==0") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==0
  3,987
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3987) (" (") %3.1f (50.74455899198167) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==0
  9
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3987)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2257336343115124) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(male) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("male") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if male ==1
  3,870
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (3870) (" (") %3.1f (49.25544100801833) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & male ==1
  7
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/3870)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1808785529715762) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(male) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. tabulatevariable, variable(eth5) start(1) end(5) missing outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==1
  1,186
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1186) (" (") %3.1f (15.09481990581647) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1186)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0843170320404722) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==2
  1,220
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1220) (" (") %3.1f (15.52755504645539) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1220)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0819672131147541) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==3
  1,153
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1153) (" (") %3.1f (14.67481226931399) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==3
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1153)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.0867302688638335) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==4
  1,206
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1206) (" (") %3.1f (15.34936998854525) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==4
  4
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1206)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3316749585406302) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(eth5) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 ==5
  1,133
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1133) (" (") %3.1f (14.42026218658521) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1133)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.264783759929391) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if "missing"!="" generaterow, variable(eth5) condition(">=.") outcome(tes
> ted)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("eth5") _tab (">=.") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if eth5 >=.
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & eth5 >=.
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. tabulatevariable, variable(imd) start(1) end(5) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/5{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==1
  5,486
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (5486) (" (") %3.1f (69.82308769250351) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==1
  11
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/5486)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2005103900838498) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==2
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==2
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==3
  0
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (0) (" (") %3.1f (0) (")") _tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==3
  0
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/0)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==4
  1,545
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1545) (" (") %3.1f (19.66399389079801) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==4
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1545)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1294498381877023) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(imd) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("imd") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if imd ==5
  826
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (826) (" (") %3.1f (10.51291841669849) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & imd ==5
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/826)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3631961259079903) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(imd) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. encode region, gen(region2)

. tabulatevariable, variable(region2) start(1) end(8) outcome(tested)
  ------------------------------------------------ begin tabulatevariable ---
  - syntax, variable(varname) start(real) end(real) [missing] outcome(string)
  - foreach varlevel of numlist `start'/`end'{
  = foreach varlevel of numlist 1/8{
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==1") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==1") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==1
  815
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (815) (" (") %3.1f (10.37291587119766) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==1
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/815)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1226993865030675) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==2") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==2") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==2
  795
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (795) (" (") %3.1f (10.11836578846888) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==2
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/795)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1257861635220126) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==3") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==3") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==3
  1,566
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1566) (" (") %3.1f (19.93127147766323) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==3
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1566)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1277139208173691) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==4") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==4") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==4
  756
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (756) (" (") %3.1f (9.621993127147768) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==4
  3
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/756)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3968253968253968) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==5") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==5") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==5
  798
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (798) (" (") %3.1f (10.1565483008782) (")") _ta
> b
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==5
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/798)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.12531328320802) (")") _n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==6") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==6") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==6
  1,529
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (1529) (" (") %3.1f (19.46035382461499) (")") _
> tab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==6
  5
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/1529)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.3270111183780248) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==7") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==7") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==7
  770
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (770) (" (") %3.1f (9.800178185057911) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==7
  1
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/770)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.1298701298701299) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - generaterow, variable(`variable') condition("==`varlevel'") outcome(teste
> d)
  = generaterow, variable(region2) condition("==8") outcome(tested)
    --------------------------------------------------- begin generaterow ---
    - syntax, variable(varname) condition(string) outcome(string)
    - file write tablecontent ("`variable'") _tab ("`condition'") _tab
    = file write tablecontent ("region2") _tab ("==8") _tab
    - cou
  7,857
    - local overalldenom=r(N)
    - cou if `variable' `condition'
    = cou if region2 ==8
  828
    - local rowdenom = r(N)
    - local colpct = 100*(r(N)/`overalldenom')
    = local colpct = 100*(r(N)/7857)
    - file write tablecontent (`rowdenom') (" (") %3.1f (`colpct') (")") _tab
    = file write tablecontent (828) (" (") %3.1f (10.53837342497136) (")") _t
> ab
    - cou if tested==1 & `variable' `condition'
    = cou if tested==1 & region2 ==8
  2
    - local pct = 100*(r(N)/`rowdenom')
    = local pct = 100*(r(N)/828)
    - file write tablecontent (r(N)) (" (") %4.2f (`pct') (")") _n
    = file write tablecontent (r(N)) (" (") %4.2f (.2415458937198068) (")") _
> n
    ----------------------------------------------------- end generaterow ---
  - }
  - if "`missing'"!="" generaterow, variable(`variable') condition(">=.") out
> come(tested)
  = if ""!="" generaterow, variable(region2) condition(">=.") outcome(tested)
  -------------------------------------------------- end tabulatevariable ---

. file write tablecontent _n 

. 
. file close tablecontent

. 
end of do-file

