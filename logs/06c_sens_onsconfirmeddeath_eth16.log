-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /workspace/logs/06c_sens_onsconfirmeddeath_eth16.log
  log type:  text
 opened on:  13 Jan 2021, 18:47:06

. 
. cap file close tablecontent

. file open tablecontent using ./output/sens_onsconfirmeddeath_eth16.txt, write
>  text replace

. file write tablecontent ("Table 2: Association between ethnicity in 16 catego
> ries and confirmed COVID-19 death") _n

. file write tablecontent _tab ("Denominator") _tab ("Event") _tab ("Total pers
> on-weeks") _tab ("Rate per 1,000") _tab ("Crude") _tab _tab ("Age/Sex Adjuste
> d") _tab _tab ("Age/Sex/IMD Adjusted") _tab _tab      ("plus co-morbidities")
>  _tab _tab       ("plus hh siz")  _tab _tab  _n

. file write tablecontent _tab _tab _tab _tab _tab   ("HR") _tab ("95% CI") _ta
> b ("HR") _tab ("95% CI") _tab ("HR") _tab ("95% CI") _tab ("HR") _tab ("95% C
> I") _tab ("HR") _tab ("95% CI") _tab _tab _n

. 
. 
. use ./output/analysis_dataset_STSET_onsconfirmeddeath.dta, clear

. drop if carehome==1
(1,189 observations deleted)

. tab ethnicity_16 onsconfirmeddeath, missing 

                  |        outcome
                  |   onsconfirmeddeath
Eth 16 categories |         0          1 |     Total
------------------+----------------------+----------
          British |       311          0 |       311 
            Irish |       317          0 |       317 
      Other White |       267          1 |       268 
White + Caribbean |       276          0 |       276 
  White + African |       300          0 |       300 
    White + Asian |       339          0 |       339 
      Other mixed |       305          0 |       305 
           Indian |       291          0 |       291 
        Pakistani |       318          1 |       319 
      Bangladeshi |       333          0 |       333 
      Other Asian |       340          0 |       340 
        Caribbean |       331          0 |       331 
          African |       311          1 |       312 
      Other Black |       279          0 |       279 
          Chinese |       318          0 |       318 
            Other |       335          0 |       335 
          Unknown |     1,693          1 |     1,694 
------------------+----------------------+----------
            Total |     6,664          4 |     6,668 

. 
. /* Main Model================================================================
> =*/
. 
. /* Univariable model */ 
. 
. stcox i.ethnicity_16, strata(stp) nolog

         failure _d:  onsconfirmeddeath
   analysis time _t:  (stime_onsconfirmeddeath-origin)
             origin:  time indexdate
  enter on or after:  time indexdate
                 id:  patient_id

Stratified Cox regr. -- no ties

No. of subjects =        6,668                  Number of obs    =       6,668
No. of failures =            4
Time at risk    =      1226407
                                                LR chi2(3)       =       10.26
Log likelihood  =   -20.933087                  Prob > chi2      =      0.0165

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
ethnicity_16 |
      Irish  |   2.06e-09          .        .       .            .           .
Other White  |   4.11e+10   5.85e+10    17.19   0.000     2.53e+09    6.68e+11
White + C..  |   2.05e-09          .        .       .            .           .
White + A..  |   2.08e-09          .        .       .            .           .
White + A..  |   2.07e-09          .        .       .            .           .
Other mixed  |   2.05e-09          .        .       .            .           .
     Indian  |   2.05e-09          .        .       .            .           .
  Pakistani  |   3.31e+10          .        .       .            .           .
Bangladeshi  |   2.07e-09          .        .       .            .           .
Other Asian  |   2.06e-09          .        .       .            .           .
  Caribbean  |   2.04e-09          .        .       .            .           .
    African  |   3.33e+10   4.73e+10    17.07   0.000     2.07e+09    5.38e+11
Other Black  |   2.05e-09          .        .       .            .           .
    Chinese  |   2.07e-09          .        .       .            .           .
      Other  |   2.07e-09          .        .       .            .           .
    Unknown  |   6.24e+09   8.85e+09    15.91   0.000     3.88e+08    1.01e+11
------------------------------------------------------------------------------
                                                             Stratified by stp

. estimates save ./output/crude_onsconfirmeddeath_eth16, replace 
file ./output/crude_onsconfirmeddeath_eth16.ster saved

. eststo model1

. parmest, label eform format(estimate p lb ub) saving(./output/crude_onsconfir
> meddeath_eth16, replace) idstr("crude_onsconfirmeddeath_eth16") 
file ./output/crude_onsconfirmeddeath_eth16.dta saved

. local hr "`hr' ./output/crude_onsconfirmeddeath_eth16 "

. 
. 
. /* Multivariable models */ 
. *Age and gender
. stcox i.ethnicity_16 i.male age1 age2 age3, strata(stp) nolog

         failure _d:  onsconfirmeddeath
   analysis time _t:  (stime_onsconfirmeddeath-origin)
             origin:  time indexdate
  enter on or after:  time indexdate
                 id:  patient_id

Stratified Cox regr. -- no ties

No. of subjects =        6,668                  Number of obs    =       6,668
No. of failures =            4
Time at risk    =      1226407
                                                LR chi2(7)       =       19.72
Log likelihood  =   -16.201384                  Prob > chi2      =      0.0062

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
ethnicity_16 |
      Irish  |   2.86e-09          .        .       .            .           .
Other White  |   4.79e+10   7.02e+10    16.78   0.000     2.71e+09    8.47e+11
White + C..  |   2.59e-09          .        .       .            .           .
White + A..  |   2.89e-09          .        .       .            .           .
White + A..  |   2.37e-09          .        .       .            .           .
Other mixed  |   4.12e-09          .        .       .            .           .
     Indian  |   2.55e-09          .        .       .            .           .
  Pakistani  |   5.08e+10          .        .       .            .           .
Bangladeshi  |   2.89e-09          .        .       .            .           .
Other Asian  |   2.56e-09          .        .       .            .           .
  Caribbean  |   4.07e-09          .        .       .            .           .
    African  |   4.06e+10   6.11e+10    16.24   0.000     2.13e+09    7.75e+11
Other Black  |   1.03e-09          .        .       .            .           .
    Chinese  |   2.61e-09          .        .       .            .           .
      Other  |   3.68e-09          .        .       .            .           .
    Unknown  |   7.26e+09   1.08e+10    15.31   0.000     3.97e+08    1.33e+11
             |
        male |
       Male  |   .2873327   .3447041    -1.04   0.299     .0273669    3.016791
        age1 |   .6495338   .1763477    -1.59   0.112     .3815061    1.105865
        age2 |   4.071666   4.371146     1.31   0.191     .4965497    33.38732
        age3 |   .0505752   .1275055    -1.18   0.237     .0003614    7.077949
------------------------------------------------------------------------------
                                                             Stratified by stp

. estimates save ./output/model0_onsconfirmeddeath_eth16, replace 
file ./output/model0_onsconfirmeddeath_eth16.ster saved

. eststo model2

. 
. parmest, label eform format(estimate p lb ub) saving(./output/model0_onsconfi
> rmeddeath_eth16, replace) idstr("model0_onsconfirmeddeath_eth16")
file ./output/model0_onsconfirmeddeath_eth16.dta saved

. local hr "`hr' ./output/model0_onsconfirmeddeath_eth16 "

.  
. 
. * Age, Gender, IMD
. 
. stcox i.ethnicity_16 i.male age1 age2 age3 i.imd, strata(stp) nolog

         failure _d:  onsconfirmeddeath
   analysis time _t:  (stime_onsconfirmeddeath-origin)
             origin:  time indexdate
  enter on or after:  time indexdate
                 id:  patient_id

Stratified Cox regr. -- no ties

No. of subjects =        6,668                  Number of obs    =       6,668
No. of failures =            4
Time at risk    =      1226407
                                                LR chi2(8)       =       22.11
Log likelihood  =   -15.008339                  Prob > chi2      =      0.0047

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
ethnicity_16 |
      Irish  |   2.18e-09          .        .       .            .           .
Other White  |   3.16e+10   4.79e+10    15.93   0.000     1.61e+09    6.19e+11
White + C..  |   2.47e-09          .        .       .            .           .
White + A..  |   2.03e-09          .        .       .            .           .
White + A..  |   2.11e-09          .        .       .            .           .
Other mixed  |   4.45e-09          .        .       .            .           .
     Indian  |   2.71e-09          .        .       .            .           .
  Pakistani  |   4.48e+10          .        .       .            .           .
Bangladeshi  |   2.64e-09          .        .       .            .           .
Other Asian  |   2.31e-09          .        .       .            .           .
  Caribbean  |   2.49e-09          .        .       .            .           .
    African  |   2.32e+10   3.68e+10    15.05   0.000     1.04e+09    5.19e+11
Other Black  |   8.96e-10          .        .       .            .           .
    Chinese  |   2.07e-09          .        .       .            .           .
      Other  |   1.21e-09          .        .       .            .           .
    Unknown  |   4.35e+09   6.79e+09    14.22   0.000     2.04e+08    9.28e+10
             |
        male |
       Male  |   .2682607   .3235817    -1.09   0.275     .0252244     2.85295
        age1 |   .6434441   .1799626    -1.58   0.115      .371913    1.113218
        age2 |   4.234146   4.706767     1.30   0.194     .4792388     37.4093
        age3 |   .0460308    .120369    -1.18   0.239     .0002736    7.743057
             |
         imd |
          4  |   4.008192   4.476594     1.24   0.214     .4490294    35.77852
5 most de..  |   2.78e-19          .        .       .            .           .
------------------------------------------------------------------------------
                                                             Stratified by stp

. if _rc==0{
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Stratified Cox regr. -- no ties

No. of subjects =        6,668                  Number of obs    =       6,668
No. of failures =            4
Time at risk    =      1226407
                                                LR chi2(8)       =       22.11
Log likelihood  =   -15.008339                  Prob > chi2      =      0.0047

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
ethnicity_16 |
      Irish  |   2.18e-09          .        .       .            .           .
Other White  |   3.16e+10   4.79e+10    15.93   0.000     1.61e+09    6.19e+11
White + C..  |   2.47e-09          .        .       .            .           .
White + A..  |   2.03e-09          .        .       .            .           .
White + A..  |   2.11e-09          .        .       .            .           .
Other mixed  |   4.45e-09          .        .       .            .           .
     Indian  |   2.71e-09          .        .       .            .           .
  Pakistani  |   4.48e+10          .        .       .            .           .
Bangladeshi  |   2.64e-09          .        .       .            .           .
Other Asian  |   2.31e-09          .        .       .            .           .
  Caribbean  |   2.49e-09          .        .       .            .           .
    African  |   2.32e+10   3.68e+10    15.05   0.000     1.04e+09    5.19e+11
Other Black  |   8.96e-10          .        .       .            .           .
    Chinese  |   2.07e-09          .        .       .            .           .
      Other  |   1.21e-09          .        .       .            .           .
    Unknown  |   4.35e+09   6.79e+09    14.22   0.000     2.04e+08    9.28e+10
             |
        male |
       Male  |   .2682607   .3235817    -1.09   0.275     .0252244     2.85295
        age1 |   .6434441   .1799626    -1.58   0.115      .371913    1.113218
        age2 |   4.234146   4.706767     1.30   0.194     .4792388     37.4093
        age3 |   .0460308    .120369    -1.18   0.239     .0002736    7.743057
             |
         imd |
          4  |   4.008192   4.476594     1.24   0.214     .4490294    35.77852
5 most de..  |   2.78e-19          .        .       .            .           .
------------------------------------------------------------------------------
                                                             Stratified by stp
. estimates save ./output/model1_onsconfirmeddeath_eth16, replace 
file ./output/model1_onsconfirmeddeath_eth16.ster saved
. eststo model3
. 
. parmest, label eform format(estimate p lb ub) saving(./output/model1_onsconfi
> rmeddeath_eth16, replace) idstr("model1_onsconfirmeddeath_eth16") 
file ./output/model1_onsconfirmeddeath_eth16.dta saved
. local hr "`hr' ./output/model1_onsconfirmeddeath_eth16 "
. }

. else di "WARNING MODEL1 DID NOT FIT (OUTCOME onsconfirmeddeath)"

. 
. * Age, Gender, IMD and Comorbidities 
. stcox i.ethnicity_16 i.male age1 age2 age3      i.imd                        
>                    ///
>                                                                              
>    i.bmicat_sa     i.hba1ccat                      ///
>                                                                              
>    gp_consult_count                        ///
>                                                                              
>    i.smoke_nomiss                          ///
>                                                                              
>    i.hypertension i.bp_cat         ///     
>                                                                              
>    i.asthma                                        ///
>                                                                              
>    i.chronic_respiratory_disease ///
>                                                                              
>    i.chronic_cardiac_disease       ///
>                                                                              
>    i.dm_type                                       ///     
>                                                                              
>    i.cancer                    ///
>                                                                              
>    i.chronic_liver_disease         ///
>                                                                              
>    i.stroke                                        ///
>                                                                              
>    i.dementia                                      ///
>                                                                              
>    i.other_neuro                           ///
>                                                                              
>    i.egfr60                                        ///
>                                                                              
>    i.esrf                                          ///
>                                                                              
>    i.immunosuppressed                      ///
>                                                                              
>    i.ra_sle_psoriasis, strata(stp) nolog           

         failure _d:  onsconfirmeddeath
   analysis time _t:  (stime_onsconfirmeddeath-origin)
             origin:  time indexdate
  enter on or after:  time indexdate
                 id:  patient_id

Stratified Cox regr. -- no ties

No. of subjects =        6,668                  Number of obs    =       6,668
No. of failures =            4
Time at risk    =      1226407
                                                LR chi2(36)      =       52.12
Log likelihood  =   -1.421e-14                  Prob > chi2      =      0.0401

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
ethnicity_16 |
      Irish  |   1.05e-12   .0011837    -0.00   1.000            0           .
Other White  |   9.80e+26   5.34e+34     0.00   1.000            0           .
White + C..  |   1.56e+13   2.87e+21     0.00   1.000            0           .
White + A..  |   3.55e-12   .0037863    -0.00   1.000            0           .
White + A..  |   .0000305   4145.156    -0.00   1.000            0           .
Other mixed  |   4.86e+07          .        .       .            .           .
     Indian  |   .0002316   63827.69    -0.00   1.000            0           .
  Pakistani  |   7.89e+24          .        .       .            .           .
Bangladeshi  |   1.74e+12   7.94e+20     0.00   1.000            0           .
Other Asian  |   1.635193   3.99e+08     0.00   1.000            0           .
  Caribbean  |   .1321015          .        .       .            .           .
    African  |   4.78e+15   3.70e+23     0.00   1.000            0           .
Other Black  |   9.739193          .        .       .            .           .
    Chinese  |   1.44e-11   .0015207    -0.00   1.000            0           .
      Other  |   3.96e-43          .        .       .            .           .
    Unknown  |   2.43e-09          .        .       .            .           .
             |
        male |
       Male  |   3.23e-08   1.559786    -0.00   1.000            0           .
        age1 |   .0028996   11199.59    -0.00   1.000            0           .
        age2 |   196044.8   6.55e+11     0.00   1.000            0           .
        age3 |   4.93e-09          .        .       .            .           .
             |
         imd |
          4  |   3.14e+10   2.48e+18     0.00   1.000            0           .
5 most de..  |   .0000544    8031.14    -0.00   1.000            0           .
             |
   bmicat_sa |
Normal (..)  |   1.55e+31   1.28e+39     0.00   1.000            0           .
Overweig..)  |   2.99e+12          .        .       .            .           .
Obese I ..)  |   6.01e+41          .        .       .            .           .
Obese II..)  |   2.14e+08   4.44e+16     0.00   1.000            0           .
Obese II..)  |   2.76e+23   1.53e+31     0.00   1.000            0           .
    Unknown  |   1.58e+07   9.75e+14     0.00   1.000            0           .
             |
    hba1ccat |
  >=6.5-7.4  |   4.23e-07          .        .       .            .           .
  >=7.5-7.9  |    2137973          .        .       .            .           .
    >=8-8.9  |   20803.76   1.92e+12     0.00   1.000            0           .
        >=9  |   6.79e+07   3.82e+16     0.00   1.000            0           .
    Unknown  |   3.21e+09          .        .       .            .           .
             |
gp_consult~t |    2.35318   2.76e+07     0.00   1.000            0           .
             |
smoke_nomiss |
     Former  |   3.84e+08   2.22e+17     0.00   1.000            0           .
    Current  |   3.33e-14          .        .       .            .           .
             |
1.hyperten~n |   1.62e-15   9.41e-08    -0.00   1.000            0           .
             |
      bp_cat |
High, sta..  |   2.20e-06          .        .       .            .           .
    Unknown  |   1.62e-25          .        .       .            .           .
             |
    1.asthma |   2.30e+14   2.01e+22     0.00   1.000            0           .
1.~y_disease |   9.86e-12   .0006698    -0.00   1.000            0           .
1.~c_disease |   859.0991   5.93e+10     0.00   1.000            0           .
             |
     dm_type |
       T1DM  |   5.99e+19   1.95e+28     0.00   1.000            0           .
       T2DM  |   1.70e+15   1.06e+23     0.00   1.000            0           .
 UNKNOWN_DM  |   1.33e+28          .        .       .            .           .
             |
    1.cancer |   3.49e-14          .        .       .            .           .
1.~r_disease |   1.82e+24   9.46e+31     0.00   1.000            0           .
    1.stroke |   1.36e+15   1.28e+23     0.00   1.000            0           .
  1.dementia |   2.39e-23          .        .       .            .           .
1.other_ne~o |   3.56e+12   1.63e+20     0.00   1.000            0           .
             |
      egfr60 |
   eGFR <60  |   3.84e+23   1.08e+33     0.00   1.000            0           .
      1.esrf |   464216.6   3.16e+13     0.00   1.000            0           .
1.immunosu~d |   .0000333   1846.054    -0.00   1.000            0           .
1.ra_sle_p~s |   7.08e-06   373.2279    -0.00   1.000            0           .
------------------------------------------------------------------------------
                                                             Stratified by stp

. if _rc==0{
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Stratified Cox regr. -- no ties

No. of subjects =        6,668                  Number of obs    =       6,668
No. of failures =            4
Time at risk    =      1226407
                                                LR chi2(36)      =       52.12
Log likelihood  =   -1.421e-14                  Prob > chi2      =      0.0401

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
ethnicity_16 |
      Irish  |   1.05e-12   .0011837    -0.00   1.000            0           .
Other White  |   9.80e+26   5.34e+34     0.00   1.000            0           .
White + C..  |   1.56e+13   2.87e+21     0.00   1.000            0           .
White + A..  |   3.55e-12   .0037863    -0.00   1.000            0           .
White + A..  |   .0000305   4145.156    -0.00   1.000            0           .
Other mixed  |   4.86e+07          .        .       .            .           .
     Indian  |   .0002316   63827.69    -0.00   1.000            0           .
  Pakistani  |   7.89e+24          .        .       .            .           .
Bangladeshi  |   1.74e+12   7.94e+20     0.00   1.000            0           .
Other Asian  |   1.635193   3.99e+08     0.00   1.000            0           .
  Caribbean  |   .1321015          .        .       .            .           .
    African  |   4.78e+15   3.70e+23     0.00   1.000            0           .
Other Black  |   9.739193          .        .       .            .           .
    Chinese  |   1.44e-11   .0015207    -0.00   1.000            0           .
      Other  |   3.96e-43          .        .       .            .           .
    Unknown  |   2.43e-09          .        .       .            .           .
             |
        male |
       Male  |   3.23e-08   1.559786    -0.00   1.000            0           .
        age1 |   .0028996   11199.59    -0.00   1.000            0           .
        age2 |   196044.8   6.55e+11     0.00   1.000            0           .
        age3 |   4.93e-09          .        .       .            .           .
             |
         imd |
          4  |   3.14e+10   2.48e+18     0.00   1.000            0           .
5 most de..  |   .0000544    8031.14    -0.00   1.000            0           .
             |
   bmicat_sa |
Normal (..)  |   1.55e+31   1.28e+39     0.00   1.000            0           .
Overweig..)  |   2.99e+12          .        .       .            .           .
Obese I ..)  |   6.01e+41          .        .       .            .           .
Obese II..)  |   2.14e+08   4.44e+16     0.00   1.000            0           .
Obese II..)  |   2.76e+23   1.53e+31     0.00   1.000            0           .
    Unknown  |   1.58e+07   9.75e+14     0.00   1.000            0           .
             |
    hba1ccat |
  >=6.5-7.4  |   4.23e-07          .        .       .            .           .
  >=7.5-7.9  |    2137973          .        .       .            .           .
    >=8-8.9  |   20803.76   1.92e+12     0.00   1.000            0           .
        >=9  |   6.79e+07   3.82e+16     0.00   1.000            0           .
    Unknown  |   3.21e+09          .        .       .            .           .
             |
gp_consult~t |    2.35318   2.76e+07     0.00   1.000            0           .
             |
smoke_nomiss |
     Former  |   3.84e+08   2.22e+17     0.00   1.000            0           .
    Current  |   3.33e-14          .        .       .            .           .
             |
1.hyperten~n |   1.62e-15   9.41e-08    -0.00   1.000            0           .
             |
      bp_cat |
High, sta..  |   2.20e-06          .        .       .            .           .
    Unknown  |   1.62e-25          .        .       .            .           .
             |
    1.asthma |   2.30e+14   2.01e+22     0.00   1.000            0           .
1.~y_disease |   9.86e-12   .0006698    -0.00   1.000            0           .
1.~c_disease |   859.0991   5.93e+10     0.00   1.000            0           .
             |
     dm_type |
       T1DM  |   5.99e+19   1.95e+28     0.00   1.000            0           .
       T2DM  |   1.70e+15   1.06e+23     0.00   1.000            0           .
 UNKNOWN_DM  |   1.33e+28          .        .       .            .           .
             |
    1.cancer |   3.49e-14          .        .       .            .           .
1.~r_disease |   1.82e+24   9.46e+31     0.00   1.000            0           .
    1.stroke |   1.36e+15   1.28e+23     0.00   1.000            0           .
  1.dementia |   2.39e-23          .        .       .            .           .
1.other_ne~o |   3.56e+12   1.63e+20     0.00   1.000            0           .
             |
      egfr60 |
   eGFR <60  |   3.84e+23   1.08e+33     0.00   1.000            0           .
      1.esrf |   464216.6   3.16e+13     0.00   1.000            0           .
1.immunosu~d |   .0000333   1846.054    -0.00   1.000            0           .
1.ra_sle_p~s |   7.08e-06   373.2279    -0.00   1.000            0           .
------------------------------------------------------------------------------
                                                             Stratified by stp
. estimates save ./output/model2_onsconfirmeddeath_eth16, replace 
file ./output/model2_onsconfirmeddeath_eth16.ster saved
. eststo model4
. 
. parmest, label eform format(estimate p lb ub) saving(./output/model2_onsconfi
> rmeddeath_eth16, replace) idstr("model2_onsconfirmeddeath_eth16") 
file ./output/model2_onsconfirmeddeath_eth16.dta saved
. local hr "`hr' ./output/model2_onsconfirmeddeath_eth16 "
. }

. else di "WARNING MODEL2 DID NOT FIT (OUTCOME onsconfirmeddeath)"

. 
.                                                                              
>    
. * Age, Gender, IMD and Comorbidities  and household size 
. stcox i.ethnicity_16 i.male age1 age2 age3      i.imd                        
>                    ///
>                                                                              
>    i.bmicat_sa     i.hba1ccat                      ///
>                                                                              
>    gp_consult_count                        ///
>                                                                              
>    i.smoke_nomiss                          ///
>                                                                              
>    i.hypertension i.bp_cat         ///     
>                                                                              
>    i.asthma                                        ///
>                                                                              
>    i.chronic_respiratory_disease ///
>                                                                              
>    i.chronic_cardiac_disease       ///
>                                                                              
>    i.dm_type                                       ///     
>                                                                              
>    i.cancer                    ///
>                                                                              
>    i.chronic_liver_disease         ///
>                                                                              
>    i.stroke                                        ///
>                                                                              
>    i.dementia                                      ///
>                                                                              
>    i.other_neuro                           ///
>                                                                              
>    i.egfr60                                        ///
>                                                                              
>    i.esrf                                          ///
>                                                                              
>    i.immunosuppressed                      ///
>                                                                              
>    i.ra_sle_psoriasis                      ///
>                                                                              
>    i.hh_total_cat, strata(stp) nolog               

         failure _d:  onsconfirmeddeath
   analysis time _t:  (stime_onsconfirmeddeath-origin)
             origin:  time indexdate
  enter on or after:  time indexdate
                 id:  patient_id

Stratified Cox regr. -- no ties

No. of subjects =        6,668                  Number of obs    =       6,668
No. of failures =            4
Time at risk    =      1226407
                                                LR chi2(18)      =       52.12
Log likelihood  =   -3.553e-15                  Prob > chi2      =      0.0000

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
ethnicity_16 |
      Irish  |   1.12e+17          .        .       .            .           .
Other White  |   3.80e+33          .        .       .            .           .
White + C..  |   1.55e+23          .        .       .            .           .
White + A..  |   1.09e-18          .        .       .            .           .
White + A..  |   115968.2          .        .       .            .           .
Other mixed  |   1.09e+16   6.92e+24     0.00   1.000            0           .
     Indian  |   1.51e+09          .        .       .            .           .
  Pakistani  |   9.00e+34          .        .       .            .           .
Bangladeshi  |   7.75e+18   1.98e+27     0.00   1.000            0           .
Other Asian  |   4.46e+16          .        .       .            .           .
  Caribbean  |   1.33e+19   2.23e+27     0.00   1.000            0           .
    African  |   2.74e+19          .        .       .            .           .
Other Black  |    62.2124          .        .       .            .           .
    Chinese  |   .0000129          .        .       .            .           .
      Other  |   1.31e+08   5.67e+16     0.00   1.000            0           .
    Unknown  |   .0375941    4241626    -0.00   1.000            0           .
             |
        male |
       Male  |   1.48e-07          .        .       .            .           .
        age1 |   .0003796   2066.425    -0.00   1.000            0           .
        age2 |   1.74e+07          .        .       .            .           .
        age3 |   7.52e-12          .        .       .            .           .
             |
         imd |
          4  |   2.48e+14   1.54e+22     0.00   1.000            0           .
5 most de..  |   6.99e-10          .        .       .            .           .
             |
   bmicat_sa |
Normal (..)  |   9.13e+22          .        .       .            .           .
Overweig..)  |   3.75e+13   2.80e+21     0.00   1.000            0           .
Obese I ..)  |   2.33e+34   1.69e+42     0.00   1.000            0           .
Obese II..)  |    1848684          .        .       .            .           .
Obese II..)  |   3.09e+17          .        .       .            .           .
    Unknown  |   3.319393          .        .       .            .           .
             |
    hba1ccat |
  >=6.5-7.4  |     443952          .        .       .            .           .
  >=7.5-7.9  |   4.80e+07          .        .       .            .           .
    >=8-8.9  |   1.05e+09   7.39e+16     0.00   1.000            0           .
        >=9  |   727993.5          .        .       .            .           .
    Unknown  |   274.3545   5.67e+10     0.00   1.000            0           .
             |
gp_consult~t |   .1924386    9001485    -0.00   1.000            0           .
             |
smoke_nomiss |
     Former  |   1.18e+18          .        .       .            .           .
    Current  |   .0043401          .        .       .            .           .
             |
1.hyperten~n |   2.34e-14          .        .       .            .           .
             |
      bp_cat |
High, sta..  |   6.07e+13          .        .       .            .           .
    Unknown  |   4.32e+07   3.12e+15     0.00   1.000            0           .
             |
    1.asthma |   4.81e+08   3.24e+17     0.00   1.000            0           .
1.~y_disease |   1.45e-07          .        .       .            .           .
1.~c_disease |   .0000386   3911.255    -0.00   1.000            0           .
             |
     dm_type |
       T1DM  |   2.39e+20   2.88e+28     0.00   1.000            0           .
       T2DM  |   1.03e+19          .        .       .            .           .
 UNKNOWN_DM  |   4.18e+13          .        .       .            .           .
             |
    1.cancer |   4.10e-22          .        .       .            .           .
1.~r_disease |   5.00e+31          .        .       .            .           .
    1.stroke |   3.01e+10          .        .       .            .           .
  1.dementia |   9.95e-20          .        .       .            .           .
1.other_ne~o |   2.06e+12   1.19e+20     0.00   1.000            0           .
             |
      egfr60 |
   eGFR <60  |   1.87e-22          .        .       .            .           .
      1.esrf |   14272.82          .        .       .            .           .
1.immunosu~d |   .0001643    22136.2    -0.00   1.000            0           .
1.ra_sle_p~s |   1.89e-10          .        .       .            .           .
             |
hh_total_cat |
       6-10  |   .2766226          .        .       .            .           .
        11+  |   2.40e+31          .        .       .            .           .
------------------------------------------------------------------------------
                                                             Stratified by stp

. estimates save ./output/model3_onsconfirmeddeath_eth16, replace
file ./output/model3_onsconfirmeddeath_eth16.ster saved

. eststo model5

. 
. parmest, label eform format(estimate p lb ub) saving(./output/model3_onsconfi
> rmeddeath_eth16, replace) idstr("model3_onsconfirmeddeath_eth16") 
file ./output/model3_onsconfirmeddeath_eth16.dta saved

. local hr "`hr' ./output/model3_onsconfirmeddeath_eth16 "

. 
. 
. 
. /* Estout================================================================*/ 
. esttab model1 model2 model3 model4 model5 using ./output/estout_onsconfirmedd
> eath_eth16.txt, b(a2) ci(2) label wide compress eform ///
>         title ("onsconfirmeddeath") ///
>         varlabels(`e(labels)') ///
>         stats(N_sub) ///
>         append 
(note: file ./output/estout_onsconfirmeddeath_eth16.txt not found)
(output written to ./output/estout_onsconfirmeddeath_eth16.txt)

. eststo clear

. 
.                                                                              
>    
. /* Print table===============================================================
> =*/ 
. *  Print the results for the main model 
. 
. 
. * Column headings 
. file write tablecontent ("onsconfirmeddeath") _n

. 
. * eth16 labelled columns
. 
. local lab1: label ethnicity_16 1

. local lab2: label ethnicity_16 2

. local lab3: label ethnicity_16 3

. local lab4: label ethnicity_16 4

. local lab5: label ethnicity_16 5

. local lab6: label ethnicity_16 6

. local lab7: label ethnicity_16 7

. local lab8: label ethnicity_16 8

. local lab9: label ethnicity_16 9

. local lab10: label ethnicity_16 10

. local lab11: label ethnicity_16 11

. local lab12: label ethnicity_16 12

. local lab13: label ethnicity_16 13

. local lab14: label ethnicity_16 14

. local lab15: label ethnicity_16 15

. local lab16: label ethnicity_16 16

. local lab17: label ethnicity_16 17

. 
. /* counts */
.  
. * First row, eth16 = 1 (White British) reference cat
.         qui safecount if ethnicity_16==1

.         local denominator = r(N)

.         qui safecount if ethnicity_16 == 1 & onsconfirmeddeath == 1

.         local event = r(N)

.     bysort eth16: egen total_follow_up = total(_t)

.         qui su total_follow_up if ethnicity_16 == 1

.         local person_week = r(mean)/7

.         local rate = 1000*(`event'/`person_week')

.         
.         file write tablecontent  ("`lab1'") _tab (`denominator') _tab (`event
> ') _tab %10.0f (`person_week') _tab %3.2f (`rate') _tab

.         file write tablecontent ("1.00") _tab _tab ("1.00") _tab _tab ("1.00"
> )  _tab _tab ("1.00") _tab _tab ("1.00") _n

.         
. * Subsequent ethnic groups
. forvalues eth=2/17 {
  2.         qui safecount if ethnicity_16==`eth'
  3.         local denominator = r(N)
  4.         qui safecount if ethnicity_16 == `eth' & onsconfirmeddeath == 1
  5.         local event = r(N)
  6.         qui su total_follow_up if ethnicity_16 == `eth'
  7.         local person_week = r(mean)/7
  8.         local rate = 1000*(`event'/`person_week')
  9.         file write tablecontent  ("`lab`eth''") _tab (`denominator') _tab 
> (`event') _tab %10.0f (`person_week') _tab %3.2f (`rate') _tab  
 10.         cap estimates use ./output/crude_onsconfirmeddeath_eth16 
 11.          cap lincom `eth'.ethnicity_16, eform
 12.         file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f (r(l
> b)) (" - ") %4.2f (r(ub)) (")") _tab 
 13.         cap estimates clear
 14.         cap estimates use ./output/model0_onsconfirmeddeath_eth16 
 15.          cap lincom `eth'.ethnicity_16, eform
 16.         file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f (r(l
> b)) (" - ") %4.2f (r(ub)) (")") _tab 
 17.         cap estimates clear
 18.         cap estimates use ./output/model1_onsconfirmeddeath_eth16 
 19.          cap lincom `eth'.ethnicity_16, eform
 20.         file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f (r(l
> b)) (" - ") %4.2f (r(ub)) (")") _tab 
 21.         cap estimates clear
 22.         cap estimates use ./output/model2_onsconfirmeddeath_eth16 
 23.          cap lincom `eth'.ethnicity_16, eform
 24.         file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f (r(l
> b)) (" - ") %4.2f (r(ub)) (")") _tab 
 25.         cap estimates clear
 26.         cap estimates use ./output/model3_onsconfirmeddeath_eth16 
 27.          cap lincom `eth'.ethnicity_16, eform
 28.         file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f (r(l
> b)) (" - ") %4.2f (r(ub)) (")") _n
 29. }  //end ethnic group

. 
. 
. file close tablecontent

. 
. ************************************************create forestplot dataset
. dsconcat `hr'

. duplicates drop

Duplicates in terms of all variables

(0 observations are duplicates)

. split idstr, p(_)
variables created as string: 
idstr1  idstr2  idstr3

. ren idstr1 model

. ren idstr2 outcome

. drop idstr idstr3

. tab model

      model |      Freq.     Percent        Cum.
------------+-----------------------------------
      crude |         17        7.83        7.83
     model0 |         22       10.14       17.97
     model1 |         25       11.52       29.49
     model2 |         75       34.56       64.06
     model3 |         78       35.94      100.00
------------+-----------------------------------
      Total |        217      100.00

. 
. *save dataset for later
. outsheet using ./output/FP_sens_onsconfirmeddeath_eth16.txt, replace
(note: file ./output/FP_sens_onsconfirmeddeath_eth16.txt not found)

. 
. * Close log file 
. log close
      name:  <unnamed>
       log:  /workspace/logs/06c_sens_onsconfirmeddeath_eth16.log
  log type:  text
 closed on:  13 Jan 2021, 18:50:08
-------------------------------------------------------------------------------
